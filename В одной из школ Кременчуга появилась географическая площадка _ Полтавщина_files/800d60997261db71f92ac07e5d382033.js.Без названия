;(function($){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a256='',r64=[256],r256=[256],i=0;var UTF8={encode:function(strUni){var strUtf=strUni.replace(/[\u0080-\u07ff]/g,function(c){var cc=c.charCodeAt(0);return String.fromCharCode(0xc0|cc>>6,0x80|cc&0x3f);}).replace(/[\u0800-\uffff]/g,function(c){var cc=c.charCodeAt(0);return String.fromCharCode(0xe0|cc>>12,0x80|cc>>6&0x3F,0x80|cc&0x3f);});return strUtf;},decode:function(strUtf){var strUni=strUtf.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(c){var cc=((c.charCodeAt(0)&0x0f)<<12)|((c.charCodeAt(1)&0x3f)<<6)|(c.charCodeAt(2)&0x3f);return String.fromCharCode(cc);}).replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(c){var cc=(c.charCodeAt(0)&0x1f)<<6|c.charCodeAt(1)&0x3f;return String.fromCharCode(cc);});return strUni;}};while(i<256){var c=String.fromCharCode(i);a256+=c;r256[i]=i;r64[i]=b64.indexOf(c);++i;}function code(s,discard,alpha,beta,w1,w2){s=String(s);var buffer=0,i=0,length=s.length,result='',bitsInBuffer=0;while(i<length){var c=s.charCodeAt(i);c=c<256?alpha[c]:-1;buffer=(buffer<<w1)+c;bitsInBuffer+=w1;while(bitsInBuffer>=w2){bitsInBuffer-=w2;var tmp=buffer>>bitsInBuffer;result+=beta.charAt(tmp);buffer^=tmp<<bitsInBuffer;}++i;}if(!discard&&bitsInBuffer>0)result+=beta.charAt(buffer<<(w2-bitsInBuffer));return result;}var Plugin=$.base64=function(dir,input,encode){return input?Plugin[dir](input,encode):dir?null:this;};Plugin.btoa=Plugin.encode=function(plain,utf8encode){plain=Plugin.raw===false||Plugin.utf8encode||utf8encode?UTF8.encode(plain):plain;plain=code(plain,false,r256,b64,8,6);return plain+'===='.slice((plain.length%4)||4);};Plugin.atob=Plugin.decode=function(coded,utf8decode){coded=coded.replace(/[^A-Za-z0-9\+\/\=]/g,"");coded=String(coded).split('=');var i=coded.length;do{--i;coded[i]=code(coded[i],true,r64,a256,6,8);}while(i>0);coded=coded.join('');return Plugin.raw===false||Plugin.utf8decode||utf8decode?UTF8.decode(coded):coded;};}(jQuery));jQuery.cookie=function(name,value,options){if(typeof value!='undefined'){options=options||{};if(value===null){value='';options.expires=-1;}var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var date;if(typeof options.expires=='number'){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000));}else{date=options.expires;}expires='; expires='+date.toUTCString();}var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('');}else{var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}return cookieValue;}};var Dialog={DOM:{},BaseInit:false,Config:{},ScrollY:-1,Open:function(config){Dialog.DOM.BlurTarget=$('.template-width-limit');Dialog.Close();Dialog.Overlay.Create();Dialog.Create(config);if(Dialog.BaseInit==false){$(document).bind('keydown',function(event){if(event.keyCode==27)Dialog.Close();});Template.AddResize(Dialog.OnResize,110);$(window).bind('scroll',Dialog.OnScroll);Dialog.BaseInit=true;}},OnResize:function(){if(typeof(Dialog.DOM.Holder)=='undefined')return;if(Template.IsMobile){Dialog.Close();return;}Dialog.Overlay.Resize();Dialog.LocateDialog();},OnScroll:function(){if(Dialog.DOM.Holder==null)return;var scroll_top=parseInt($(document).scrollTop());if(scroll_top==Dialog.ScrollY)return;var direction=scroll_top<Dialog.ScrollY?'up':'down';var dY=Math.abs(scroll_top-Dialog.ScrollY);Dialog.ScrollY=scroll_top;var window_height=parseInt($(window).height());var dialog_height=Dialog.DOM.Holder.height();var need_height=dialog_height+24;if(need_height<=window_height)return;document.title=dialog_height+' / '+window_height+' / '+direction;var fixed_top=parseInt(Dialog.DOM.Holder.css('top'));var dialog_top=scroll_top+fixed_top-12;var dialog_bottom=scroll_top+fixed_top+dialog_height+12;var view_top=scroll_top;var view_bottom=scroll_top+window_height;if(direction=='up'){if(dialog_top<view_top){var new_top=fixed_top+Math.min((view_top-dialog_top),dY);Dialog.DOM.Holder.css('top',new_top);}}else{if(dialog_bottom>view_bottom){var new_top=fixed_top-Math.min((dialog_bottom-view_bottom),dY);Dialog.DOM.Holder.css('top',new_top);}}},Close:function(){if(typeof(Dialog.DOM.Holder)!='undefined')Dialog.DOM.Holder.remove();if(typeof(Dialog.DOM.Overlay)!='undefined')Dialog.DOM.Overlay.remove();$('body').find('.hidden-by-overlay').css({'visibility':'visible'});if(typeof(Dialog.Config.onclose)=='function')Dialog.Config.onclose();Dialog.DOM.BlurTarget.removeClass('blur-background');Dialog.ScrollY=-1;return false;},Create:function(config1){var config={title:'',raw_content:'',content:'',width:'360px',action:'#',method:'post',extend_class:'',close_button:true,onready:null,onsubmit:null,onclose:null,buttons:[{type:'button',value:'Ok',extend_class:''}]};$.extend(config,config1);Dialog.Config=config;var ab_fn=[];var buttons='';if(config.buttons.length>0){var ab=[];for(i in config.buttons){var cb={id:'',name:'',extend_class:'',type:'button',value:'Button',fn:null};$.extend(cb,config.buttons[i]);var btn='<span class="dialog-button '+cb.extend_class+'"><input '+(cb.id!=''?'id="'+cb.id+'" ':'')+''+(cb.name!=''?'name="'+cb.name+'" ':'')+'type="'+cb.type+'" value="'+cb.value+'" /></span>';ab.push(btn);ab_fn.push(cb.fn);}buttons=ab.join(' ');}var form='<form action="'+config.action+'" method="'+config.method+'" style="margin: 0 auto 0 auto; max-width:'+config.width+';">';form+='<div class="tblock tblock-sm dialog-box relative">';form+='<div class="clear-both"></div>';if(config.title!=''){form+='<div class="tblock-header">';form+='<div class="dialog-title'+(config.close_button==true?' dialog-title-close':'')+'">';form+=config.title;if(config.close_button==true)form+='<span class="dialog-close"></span>';form+='</div>';form+='</div>';}if(config.raw_content!='')form+=config.raw_content;if(config.content!=''){form+='<div class="tblock-body">';form+='<div class="tblock-content tblock-content-bg">';form+=config.content;form+='</div>';form+='</div>';}if(buttons!=''){form+='<div class="tblock-footer">';form+='<div class="dialog-buttons">'+buttons+'</div>';form+='</div>';}form+='<div class="clear-both"></div>';form+='</div>';form+='</form>';Dialog.DOM.Holder=$('<div class="dialog-holder"></div>').addClass(config.extend_class).css({'position':'fixed','left':'0px','top':'0px','width':'100%','z-index':1001}).append(form);$('body').append(Dialog.DOM.Holder);if(ab_fn.length>0){var btn_i=0;Dialog.DOM.Holder.find('div.dialog-buttons').find('input').each(function(){var fn=ab_fn[btn_i];if(fn!=null)$(this).bind('click',fn);btn_i++;});}Dialog.LocateDialog();Dialog.DOM.Holder.find('.make-focus').focus();Dialog.DOM.Holder.find('.dialog-close').bind('click',Dialog.Close);if(typeof(config.onready)=='function')config.onready();if(typeof(config.onsubmit)=='function')Dialog.DOM.Holder.find('form:first').bind('submit',config.onsubmit);return;},LocateDialog:function(){if(typeof(Dialog.DOM.Holder)=='undefined')return;var dialog_height=Dialog.DOM.Holder.height();var window_height=$(window).height();var top=Math.max(Math.floor((window_height-dialog_height)/2),12);Dialog.DOM.Holder.css('top',top+'px');},Overlay:{Create:function(){Dialog.DOM.Overlay=$('<div class="dialog-overlay"></div>').css({'width':'100%','left':0,'top':0,'z-index':1000});Dialog.DOM.Overlay.css({'position':'fixed','height':$(window).height()+'px'});$('body').find('.overlay-hide').addClass('hidden-by-overlay').css({'visibility':'hidden'});$('body').append(Dialog.DOM.Overlay);Dialog.DOM.BlurTarget.addClass('blur-background');},Resize:function(){if(typeof(Dialog.DOM.Overlay)!='undefined')Dialog.DOM.Overlay.css('height',$(document).height()+'px');}}};!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.PhotoSwipe=b()}(this,function(){"use strict";var a=function(a,b,c,d){var e={features:null,bind:function(a,b,c,d){var e=(d?"remove":"add")+"EventListener";b=b.split(" ");for(var f=0;f<b.length;f++)b[f]&&a[e](b[f],c,!1)},isArray:function(a){return a instanceof Array},createEl:function(a,b){var c=document.createElement(b||"div");return a&&(c.className=a),c},getScrollY:function(){var a=window.pageYOffset;return void 0!==a?a:document.documentElement.scrollTop},unbind:function(a,b,c){e.bind(a,b,c,!0)},removeClass:function(a,b){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(a,b){e.hasClass(a,b)||(a.className+=(a.className?" ":"")+b)},hasClass:function(a,b){return a.className&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(a.className)},getChildByClass:function(a,b){for(var c=a.firstChild;c;){if(e.hasClass(c,b))return c;c=c.nextSibling}},arraySearch:function(a,b,c){for(var d=a.length;d--;)if(a[d][c]===b)return d;return-1},extend:function(a,b,c){for(var d in b)if(b.hasOwnProperty(d)){if(c&&a.hasOwnProperty(d))continue;a[d]=b[d]}},easing:{sine:{out:function(a){return Math.sin(a*(Math.PI/2))},inOut:function(a){return-(Math.cos(Math.PI*a)-1)/2}},cubic:{out:function(a){return--a*a*a+1}}},detectFeatures:function(){if(e.features)return e.features;var a=e.createEl(),b=a.style,c="",d={};if(d.oldIE=document.all&&!document.addEventListener,d.touch="ontouchstart"in window,window.requestAnimationFrame&&(d.raf=window.requestAnimationFrame,d.caf=window.cancelAnimationFrame),d.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled,!d.pointerEvent){var f=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var g=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);g&&g.length>0&&(g=parseInt(g[1],10),g>=1&&g<8&&(d.isOldIOSPhone=!0))}var h=f.match(/Android\s([0-9\.]*)/),i=h?h[1]:0;i=parseFloat(i),i>=1&&(i<4.4&&(d.isOldAndroid=!0),d.androidVersion=i),d.isMobileOpera=/opera mini|opera mobi/i.test(f)}for(var j,k,l=["transform","perspective","animationName"],m=["","webkit","Moz","ms","O"],n=0;n<4;n++){c=m[n];for(var o=0;o<3;o++)j=l[o],k=c+(c?j.charAt(0).toUpperCase()+j.slice(1):j),!d[j]&&k in b&&(d[j]=k);c&&!d.raf&&(c=c.toLowerCase(),d.raf=window[c+"RequestAnimationFrame"],d.raf&&(d.caf=window[c+"CancelAnimationFrame"]||window[c+"CancelRequestAnimationFrame"]))}if(!d.raf){var p=0;d.raf=function(a){var b=(new Date).getTime(),c=Math.max(0,16-(b-p)),d=window.setTimeout(function(){a(b+c)},c);return p=b+c,d},d.caf=function(a){clearTimeout(a)}}return d.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,e.features=d,d}};e.detectFeatures(),e.features.oldIE&&(e.bind=function(a,b,c,d){b=b.split(" ");for(var e,f=(d?"detach":"attach")+"Event",g=function(){c.handleEvent.call(c)},h=0;h<b.length;h++)if(e=b[h])if("object"==typeof c&&c.handleEvent){if(d){if(!c["oldIE"+e])return!1}else c["oldIE"+e]=g;a[f]("on"+e,c["oldIE"+e])}else a[f]("on"+e,c)});var f=this,g=25,h=3,i={allowPanToNext:!0,spacing:.12,bgOpacity:1,mouseUsed:!1,loop:!0,pinchToClose:!0,closeOnScroll:!0,closeOnVerticalDrag:!0,verticalDragRange:.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:!1,focus:!0,escKey:!0,arrowKeys:!0,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(a){return"A"===a.tagName},getDoubleTapZoom:function(a,b){return a?1:b.initialZoomLevel<.7?1:1.33},maxSpreadZoom:1.33,modal:!0,scaleMode:"fit"};e.extend(i,d);var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma=function(){return{x:0,y:0}},na=ma(),oa=ma(),pa=ma(),qa={},ra=0,sa={},ta=ma(),ua=0,va=!0,wa=[],xa={},ya=!1,za=function(a,b){e.extend(f,b.publicMethods),wa.push(a)},Aa=function(a){var b=ac();return a>b-1?a-b:a<0?b+a:a},Ba={},Ca=function(a,b){return Ba[a]||(Ba[a]=[]),Ba[a].push(b)},Da=function(a){var b=Ba[a];if(b){var c=Array.prototype.slice.call(arguments);c.shift();for(var d=0;d<b.length;d++)b[d].apply(f,c)}},Ea=function(){return(new Date).getTime()},Fa=function(a){ja=a,f.bg.style.opacity=a*i.bgOpacity},Ga=function(a,b,c,d,e){(!ya||e&&e!==f.currItem)&&(d/=e?e.fitRatio:f.currItem.fitRatio),a[E]=u+b+"px, "+c+"px"+v+" scale("+d+")"},Ha=function(a){ea&&(a&&(s>f.currItem.fitRatio?ya||(mc(f.currItem,!1,!0),ya=!0):ya&&(mc(f.currItem),ya=!1)),Ga(ea,pa.x,pa.y,s))},Ia=function(a){a.container&&Ga(a.container.style,a.initialPosition.x,a.initialPosition.y,a.initialZoomLevel,a)},Ja=function(a,b){b[E]=u+a+"px, 0px"+v},Ka=function(a,b){if(!i.loop&&b){var c=m+(ta.x*ra-a)/ta.x,d=Math.round(a-tb.x);(c<0&&d>0||c>=ac()-1&&d<0)&&(a=tb.x+d*i.mainScrollEndFriction)}tb.x=a,Ja(a,n)},La=function(a,b){var c=ub[a]-sa[a];return oa[a]+na[a]+c-c*(b/t)},Ma=function(a,b){a.x=b.x,a.y=b.y,b.id&&(a.id=b.id)},Na=function(a){a.x=Math.round(a.x),a.y=Math.round(a.y)},Oa=null,Pa=function(){Oa&&(e.unbind(document,"mousemove",Pa),e.addClass(a,"pswp--has_mouse"),i.mouseUsed=!0,Da("mouseUsed")),Oa=setTimeout(function(){Oa=null},100)},Qa=function(){e.bind(document,"keydown",f),N.transform&&e.bind(f.scrollWrap,"click",f),i.mouseUsed||e.bind(document,"mousemove",Pa),e.bind(window,"resize scroll orientationchange",f),Da("bindEvents")},Ra=function(){e.unbind(window,"resize scroll orientationchange",f),e.unbind(window,"scroll",r.scroll),e.unbind(document,"keydown",f),e.unbind(document,"mousemove",Pa),N.transform&&e.unbind(f.scrollWrap,"click",f),V&&e.unbind(window,p,f),clearTimeout(O),Da("unbindEvents")},Sa=function(a,b){var c=ic(f.currItem,qa,a);return b&&(da=c),c},Ta=function(a){return a||(a=f.currItem),a.initialZoomLevel},Ua=function(a){return a||(a=f.currItem),a.w>0?i.maxSpreadZoom:1},Va=function(a,b,c,d){return d===f.currItem.initialZoomLevel?(c[a]=f.currItem.initialPosition[a],!0):(c[a]=La(a,d),c[a]>b.min[a]?(c[a]=b.min[a],!0):c[a]<b.max[a]&&(c[a]=b.max[a],!0))},Wa=function(){if(E){var b=N.perspective&&!G;return u="translate"+(b?"3d(":"("),void(v=N.perspective?", 0px)":")")}E="left",e.addClass(a,"pswp--ie"),Ja=function(a,b){b.left=a+"px"},Ia=function(a){var b=a.fitRatio>1?1:a.fitRatio,c=a.container.style,d=b*a.w,e=b*a.h;c.width=d+"px",c.height=e+"px",c.left=a.initialPosition.x+"px",c.top=a.initialPosition.y+"px"},Ha=function(){if(ea){var a=ea,b=f.currItem,c=b.fitRatio>1?1:b.fitRatio,d=c*b.w,e=c*b.h;a.width=d+"px",a.height=e+"px",a.left=pa.x+"px",a.top=pa.y+"px"}}},Xa=function(a){var b="";i.escKey&&27===a.keyCode?b="close":i.arrowKeys&&(37===a.keyCode?b="prev":39===a.keyCode&&(b="next")),b&&(a.ctrlKey||a.altKey||a.shiftKey||a.metaKey||(a.preventDefault?a.preventDefault():a.returnValue=!1,f[b]()))},Ya=function(a){a&&(Y||X||fa||T)&&(a.preventDefault(),a.stopPropagation())},Za=function(){f.setScrollOffset(0,e.getScrollY())},$a={},_a=0,ab=function(a){$a[a]&&($a[a].raf&&I($a[a].raf),_a--,delete $a[a])},bb=function(a){$a[a]&&ab(a),$a[a]||(_a++,$a[a]={})},cb=function(){for(var a in $a)$a.hasOwnProperty(a)&&ab(a)},db=function(a,b,c,d,e,f,g){var h,i=Ea();bb(a);var j=function(){if($a[a]){if(h=Ea()-i,h>=d)return ab(a),f(c),void(g&&g());f((c-b)*e(h/d)+b),$a[a].raf=H(j)}};j()},eb={shout:Da,listen:Ca,viewportSize:qa,options:i,isMainScrollAnimating:function(){return fa},getZoomLevel:function(){return s},getCurrentIndex:function(){return m},isDragging:function(){return V},isZooming:function(){return aa},setScrollOffset:function(a,b){sa.x=a,M=sa.y=b,Da("updateScrollOffset",sa)},applyZoomPan:function(a,b,c,d){pa.x=b,pa.y=c,s=a,Ha(d)},init:function(){if(!j&&!k){var c;f.framework=e,f.template=a,f.bg=e.getChildByClass(a,"pswp__bg"),J=a.className,j=!0,N=e.detectFeatures(),H=N.raf,I=N.caf,E=N.transform,L=N.oldIE,f.scrollWrap=e.getChildByClass(a,"pswp__scroll-wrap"),f.container=e.getChildByClass(f.scrollWrap,"pswp__container"),n=f.container.style,f.itemHolders=y=[{el:f.container.children[0],wrap:0,index:-1},{el:f.container.children[1],wrap:0,index:-1},{el:f.container.children[2],wrap:0,index:-1}],y[0].el.style.display=y[2].el.style.display="none",Wa(),r={resize:f.updateSize,orientationchange:function(){clearTimeout(O),O=setTimeout(function(){qa.x!==f.scrollWrap.clientWidth&&f.updateSize()},500)},scroll:Za,keydown:Xa,click:Ya};var d=N.isOldIOSPhone||N.isOldAndroid||N.isMobileOpera;for(N.animationName&&N.transform&&!d||(i.showAnimationDuration=i.hideAnimationDuration=0),c=0;c<wa.length;c++)f["init"+wa[c]]();if(b){var g=f.ui=new b(f,e);g.init()}Da("firstUpdate"),m=m||i.index||0,(isNaN(m)||m<0||m>=ac())&&(m=0),f.currItem=_b(m),(N.isOldIOSPhone||N.isOldAndroid)&&(va=!1),a.setAttribute("aria-hidden","false"),i.modal&&(va?a.style.position="fixed":(a.style.position="absolute",a.style.top=e.getScrollY()+"px")),void 0===M&&(Da("initialLayout"),M=K=e.getScrollY());var l="pswp--open ";for(i.mainClass&&(l+=i.mainClass+" "),i.showHideOpacity&&(l+="pswp--animate_opacity "),l+=G?"pswp--touch":"pswp--notouch",l+=N.animationName?" pswp--css_animation":"",l+=N.svg?" pswp--svg":"",e.addClass(a,l),f.updateSize(),o=-1,ua=null,c=0;c<h;c++)Ja((c+o)*ta.x,y[c].el.style);L||e.bind(f.scrollWrap,q,f),Ca("initialZoomInEnd",function(){f.setContent(y[0],m-1),f.setContent(y[2],m+1),y[0].el.style.display=y[2].el.style.display="block",i.focus&&a.focus(),Qa()}),f.setContent(y[1],m),f.updateCurrItem(),Da("afterInit"),va||(w=setInterval(function(){_a||V||aa||s!==f.currItem.initialZoomLevel||f.updateSize()},1e3)),e.addClass(a,"pswp--visible")}},close:function(){j&&(j=!1,k=!0,Da("close"),Ra(),cc(f.currItem,null,!0,f.destroy))},destroy:function(){Da("destroy"),Xb&&clearTimeout(Xb),a.setAttribute("aria-hidden","true"),a.className=J,w&&clearInterval(w),e.unbind(f.scrollWrap,q,f),e.unbind(window,"scroll",f),zb(),cb(),Ba=null},panTo:function(a,b,c){c||(a>da.min.x?a=da.min.x:a<da.max.x&&(a=da.max.x),b>da.min.y?b=da.min.y:b<da.max.y&&(b=da.max.y)),pa.x=a,pa.y=b,Ha()},handleEvent:function(a){a=a||window.event,r[a.type]&&r[a.type](a)},goTo:function(a){a=Aa(a);var b=a-m;ua=b,m=a,f.currItem=_b(m),ra-=b,Ka(ta.x*ra),cb(),fa=!1,f.updateCurrItem()},next:function(){f.goTo(m+1)},prev:function(){f.goTo(m-1)},updateCurrZoomItem:function(a){if(a&&Da("beforeChange",0),y[1].el.children.length){var b=y[1].el.children[0];ea=e.hasClass(b,"pswp__zoom-wrap")?b.style:null}else ea=null;da=f.currItem.bounds,t=s=f.currItem.initialZoomLevel,pa.x=da.center.x,pa.y=da.center.y,a&&Da("afterChange")},invalidateCurrItems:function(){x=!0;for(var a=0;a<h;a++)y[a].item&&(y[a].item.needsUpdate=!0)},updateCurrItem:function(a){if(0!==ua){var b,c=Math.abs(ua);if(!(a&&c<2)){f.currItem=_b(m),ya=!1,Da("beforeChange",ua),c>=h&&(o+=ua+(ua>0?-h:h),c=h);for(var d=0;d<c;d++)ua>0?(b=y.shift(),y[h-1]=b,o++,Ja((o+2)*ta.x,b.el.style),f.setContent(b,m-c+d+1+1)):(b=y.pop(),y.unshift(b),o--,Ja(o*ta.x,b.el.style),f.setContent(b,m+c-d-1-1));if(ea&&1===Math.abs(ua)){var e=_b(z);e.initialZoomLevel!==s&&(ic(e,qa),mc(e),Ia(e))}ua=0,f.updateCurrZoomItem(),z=m,Da("afterChange")}}},updateSize:function(b){if(!va&&i.modal){var c=e.getScrollY();if(M!==c&&(a.style.top=c+"px",M=c),!b&&xa.x===window.innerWidth&&xa.y===window.innerHeight)return;xa.x=window.innerWidth,xa.y=window.innerHeight,a.style.height=xa.y+"px"}if(qa.x=f.scrollWrap.clientWidth,qa.y=f.scrollWrap.clientHeight,Za(),ta.x=qa.x+Math.round(qa.x*i.spacing),ta.y=qa.y,Ka(ta.x*ra),Da("beforeResize"),void 0!==o){for(var d,g,j,k=0;k<h;k++)d=y[k],Ja((k+o)*ta.x,d.el.style),j=m+k-1,i.loop&&ac()>2&&(j=Aa(j)),g=_b(j),g&&(x||g.needsUpdate||!g.bounds)?(f.cleanSlide(g),f.setContent(d,j),1===k&&(f.currItem=g,f.updateCurrZoomItem(!0)),g.needsUpdate=!1):d.index===-1&&j>=0&&f.setContent(d,j),g&&g.container&&(ic(g,qa),mc(g),Ia(g));x=!1}t=s=f.currItem.initialZoomLevel,da=f.currItem.bounds,da&&(pa.x=da.center.x,pa.y=da.center.y,Ha(!0)),Da("resize")},zoomTo:function(a,b,c,d,f){b&&(t=s,ub.x=Math.abs(b.x)-pa.x,ub.y=Math.abs(b.y)-pa.y,Ma(oa,pa));var g=Sa(a,!1),h={};Va("x",g,h,a),Va("y",g,h,a);var i=s,j={x:pa.x,y:pa.y};Na(h);var k=function(b){1===b?(s=a,pa.x=h.x,pa.y=h.y):(s=(a-i)*b+i,pa.x=(h.x-j.x)*b+j.x,pa.y=(h.y-j.y)*b+j.y),f&&f(b),Ha(1===b)};c?db("customZoomTo",0,1,c,d||e.easing.sine.inOut,k):k(1)}},fb=30,gb=10,hb={},ib={},jb={},kb={},lb={},mb=[],nb={},ob=[],pb={},qb=0,rb=ma(),sb=0,tb=ma(),ub=ma(),vb=ma(),wb=function(a,b){return a.x===b.x&&a.y===b.y},xb=function(a,b){return Math.abs(a.x-b.x)<g&&Math.abs(a.y-b.y)<g},yb=function(a,b){return pb.x=Math.abs(a.x-b.x),pb.y=Math.abs(a.y-b.y),Math.sqrt(pb.x*pb.x+pb.y*pb.y)},zb=function(){Z&&(I(Z),Z=null)},Ab=function(){V&&(Z=H(Ab),Qb())},Bb=function(){return!("fit"===i.scaleMode&&s===f.currItem.initialZoomLevel)},Cb=function(a,b){return!(!a||a===document)&&(!(a.getAttribute("class")&&a.getAttribute("class").indexOf("pswp__scroll-wrap")>-1)&&(b(a)?a:Cb(a.parentNode,b)))},Db={},Eb=function(a,b){return Db.prevent=!Cb(a.target,i.isClickableElement),Da("preventDragEvent",a,b,Db),Db.prevent},Fb=function(a,b){return b.x=a.pageX,b.y=a.pageY,b.id=a.identifier,b},Gb=function(a,b,c){c.x=.5*(a.x+b.x),c.y=.5*(a.y+b.y)},Hb=function(a,b,c){if(a-Q>50){var d=ob.length>2?ob.shift():{};d.x=b,d.y=c,ob.push(d),Q=a}},Ib=function(){var a=pa.y-f.currItem.initialPosition.y;return 1-Math.abs(a/(qa.y/2))},Jb={},Kb={},Lb=[],Mb=function(a){for(;Lb.length>0;)Lb.pop();return F?(la=0,mb.forEach(function(a){0===la?Lb[0]=a:1===la&&(Lb[1]=a),la++})):a.type.indexOf("touch")>-1?a.touches&&a.touches.length>0&&(Lb[0]=Fb(a.touches[0],Jb),a.touches.length>1&&(Lb[1]=Fb(a.touches[1],Kb))):(Jb.x=a.pageX,Jb.y=a.pageY,Jb.id="",Lb[0]=Jb),Lb},Nb=function(a,b){var c,d,e,g,h=0,j=pa[a]+b[a],k=b[a]>0,l=tb.x+b.x,m=tb.x-nb.x;return c=j>da.min[a]||j<da.max[a]?i.panEndFriction:1,j=pa[a]+b[a]*c,!i.allowPanToNext&&s!==f.currItem.initialZoomLevel||(ea?"h"!==ga||"x"!==a||X||(k?(j>da.min[a]&&(c=i.panEndFriction,h=da.min[a]-j,d=da.min[a]-oa[a]),(d<=0||m<0)&&ac()>1?(g=l,m<0&&l>nb.x&&(g=nb.x)):da.min.x!==da.max.x&&(e=j)):(j<da.max[a]&&(c=i.panEndFriction,h=j-da.max[a],d=oa[a]-da.max[a]),(d<=0||m>0)&&ac()>1?(g=l,m>0&&l<nb.x&&(g=nb.x)):da.min.x!==da.max.x&&(e=j))):g=l,"x"!==a)?void(fa||$||s>f.currItem.fitRatio&&(pa[a]+=b[a]*c)):(void 0!==g&&(Ka(g,!0),$=g!==nb.x),da.min.x!==da.max.x&&(void 0!==e?pa.x=e:$||(pa.x+=b.x*c)),void 0!==g)},Ob=function(a){if(!("mousedown"===a.type&&a.button>0)){if($b)return void a.preventDefault();if(!U||"mousedown"!==a.type){if(Eb(a,!0)&&a.preventDefault(),Da("pointerDown"),F){var b=e.arraySearch(mb,a.pointerId,"id");b<0&&(b=mb.length),mb[b]={x:a.pageX,y:a.pageY,id:a.pointerId}}var c=Mb(a),d=c.length;_=null,cb(),V&&1!==d||(V=ha=!0,e.bind(window,p,f),S=ka=ia=T=$=Y=W=X=!1,ga=null,Da("firstTouchStart",c),Ma(oa,pa),na.x=na.y=0,Ma(kb,c[0]),Ma(lb,kb),nb.x=ta.x*ra,ob=[{x:kb.x,y:kb.y}],Q=P=Ea(),Sa(s,!0),zb(),Ab()),!aa&&d>1&&!fa&&!$&&(t=s,X=!1,aa=W=!0,na.y=na.x=0,Ma(oa,pa),Ma(hb,c[0]),Ma(ib,c[1]),Gb(hb,ib,vb),ub.x=Math.abs(vb.x)-pa.x,ub.y=Math.abs(vb.y)-pa.y,ba=ca=yb(hb,ib))}}},Pb=function(a){if(a.preventDefault(),F){var b=e.arraySearch(mb,a.pointerId,"id");if(b>-1){var c=mb[b];c.x=a.pageX,c.y=a.pageY}}if(V){var d=Mb(a);if(ga||Y||aa)_=d;else if(tb.x!==ta.x*ra)ga="h";else{var f=Math.abs(d[0].x-kb.x)-Math.abs(d[0].y-kb.y);Math.abs(f)>=gb&&(ga=f>0?"h":"v",_=d)}}},Qb=function(){if(_){var a=_.length;if(0!==a)if(Ma(hb,_[0]),jb.x=hb.x-kb.x,jb.y=hb.y-kb.y,aa&&a>1){if(kb.x=hb.x,kb.y=hb.y,!jb.x&&!jb.y&&wb(_[1],ib))return;Ma(ib,_[1]),X||(X=!0,Da("zoomGestureStarted"));var b=yb(hb,ib),c=Vb(b);c>f.currItem.initialZoomLevel+f.currItem.initialZoomLevel/15&&(ka=!0);var d=1,e=Ta(),g=Ua();if(c<e)if(i.pinchToClose&&!ka&&t<=f.currItem.initialZoomLevel){var h=e-c,j=1-h/(e/1.2);Fa(j),Da("onPinchClose",j),ia=!0}else d=(e-c)/e,d>1&&(d=1),c=e-d*(e/3);else c>g&&(d=(c-g)/(6*e),d>1&&(d=1),c=g+d*e);d<0&&(d=0),ba=b,Gb(hb,ib,rb),na.x+=rb.x-vb.x,na.y+=rb.y-vb.y,Ma(vb,rb),pa.x=La("x",c),pa.y=La("y",c),S=c>s,s=c,Ha()}else{if(!ga)return;if(ha&&(ha=!1,Math.abs(jb.x)>=gb&&(jb.x-=_[0].x-lb.x),Math.abs(jb.y)>=gb&&(jb.y-=_[0].y-lb.y)),kb.x=hb.x,kb.y=hb.y,0===jb.x&&0===jb.y)return;if("v"===ga&&i.closeOnVerticalDrag&&!Bb()){na.y+=jb.y,pa.y+=jb.y;var k=Ib();return T=!0,Da("onVerticalDrag",k),Fa(k),void Ha()}Hb(Ea(),hb.x,hb.y),Y=!0,da=f.currItem.bounds;var l=Nb("x",jb);l||(Nb("y",jb),Na(pa),Ha())}}},Rb=function(a){if(N.isOldAndroid){if(U&&"mouseup"===a.type)return;a.type.indexOf("touch")>-1&&(clearTimeout(U),U=setTimeout(function(){U=0},600))}Da("pointerUp"),Eb(a,!1)&&a.preventDefault();var b;if(F){var c=e.arraySearch(mb,a.pointerId,"id");if(c>-1)if(b=mb.splice(c,1)[0],navigator.pointerEnabled)b.type=a.pointerType||"mouse";else{var d={4:"mouse",2:"touch",3:"pen"};b.type=d[a.pointerType],b.type||(b.type=a.pointerType||"mouse")}}var g,h=Mb(a),j=h.length;if("mouseup"===a.type&&(j=0),2===j)return _=null,!0;1===j&&Ma(lb,h[0]),0!==j||ga||fa||(b||("mouseup"===a.type?b={x:a.pageX,y:a.pageY,type:"mouse"}:a.changedTouches&&a.changedTouches[0]&&(b={x:a.changedTouches[0].pageX,y:a.changedTouches[0].pageY,type:"touch"})),Da("touchRelease",a,b));var k=-1;if(0===j&&(V=!1,e.unbind(window,p,f),zb(),aa?k=0:sb!==-1&&(k=Ea()-sb)),sb=1===j?Ea():-1,g=k!==-1&&k<150?"zoom":"swipe",aa&&j<2&&(aa=!1,1===j&&(g="zoomPointerUp"),Da("zoomGestureEnded")),_=null,Y||X||fa||T)if(cb(),R||(R=Sb()),R.calculateSwipeSpeed("x"),T){var l=Ib();if(l<i.verticalDragRange)f.close();else{var m=pa.y,n=ja;db("verticalDrag",0,1,300,e.easing.cubic.out,function(a){pa.y=(f.currItem.initialPosition.y-m)*a+m,Fa((1-n)*a+n),Ha()}),Da("onVerticalDrag",1)}}else{if(($||fa)&&0===j){var o=Ub(g,R);if(o)return;g="zoomPointerUp"}if(!fa)return"swipe"!==g?void Wb():void(!$&&s>f.currItem.fitRatio&&Tb(R))}},Sb=function(){var a,b,c={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(d){ob.length>1?(a=Ea()-Q+50,b=ob[ob.length-2][d]):(a=Ea()-P,b=lb[d]),c.lastFlickOffset[d]=kb[d]-b,c.lastFlickDist[d]=Math.abs(c.lastFlickOffset[d]),c.lastFlickDist[d]>20?c.lastFlickSpeed[d]=c.lastFlickOffset[d]/a:c.lastFlickSpeed[d]=0,Math.abs(c.lastFlickSpeed[d])<.1&&(c.lastFlickSpeed[d]=0),c.slowDownRatio[d]=.95,c.slowDownRatioReverse[d]=1-c.slowDownRatio[d],c.speedDecelerationRatio[d]=1},calculateOverBoundsAnimOffset:function(a,b){c.backAnimStarted[a]||(pa[a]>da.min[a]?c.backAnimDestination[a]=da.min[a]:pa[a]<da.max[a]&&(c.backAnimDestination[a]=da.max[a]),void 0!==c.backAnimDestination[a]&&(c.slowDownRatio[a]=.7,c.slowDownRatioReverse[a]=1-c.slowDownRatio[a],c.speedDecelerationRatioAbs[a]<.05&&(c.lastFlickSpeed[a]=0,c.backAnimStarted[a]=!0,db("bounceZoomPan"+a,pa[a],c.backAnimDestination[a],b||300,e.easing.sine.out,function(b){pa[a]=b,Ha()}))))},calculateAnimOffset:function(a){c.backAnimStarted[a]||(c.speedDecelerationRatio[a]=c.speedDecelerationRatio[a]*(c.slowDownRatio[a]+c.slowDownRatioReverse[a]-c.slowDownRatioReverse[a]*c.timeDiff/10),c.speedDecelerationRatioAbs[a]=Math.abs(c.lastFlickSpeed[a]*c.speedDecelerationRatio[a]),c.distanceOffset[a]=c.lastFlickSpeed[a]*c.speedDecelerationRatio[a]*c.timeDiff,pa[a]+=c.distanceOffset[a])},panAnimLoop:function(){if($a.zoomPan&&($a.zoomPan.raf=H(c.panAnimLoop),c.now=Ea(),c.timeDiff=c.now-c.lastNow,c.lastNow=c.now,c.calculateAnimOffset("x"),c.calculateAnimOffset("y"),Ha(),c.calculateOverBoundsAnimOffset("x"),c.calculateOverBoundsAnimOffset("y"),c.speedDecelerationRatioAbs.x<.05&&c.speedDecelerationRatioAbs.y<.05))return pa.x=Math.round(pa.x),pa.y=Math.round(pa.y),Ha(),void ab("zoomPan")}};return c},Tb=function(a){return a.calculateSwipeSpeed("y"),da=f.currItem.bounds,a.backAnimDestination={},a.backAnimStarted={},Math.abs(a.lastFlickSpeed.x)<=.05&&Math.abs(a.lastFlickSpeed.y)<=.05?(a.speedDecelerationRatioAbs.x=a.speedDecelerationRatioAbs.y=0,a.calculateOverBoundsAnimOffset("x"),a.calculateOverBoundsAnimOffset("y"),!0):(bb("zoomPan"),a.lastNow=Ea(),void a.panAnimLoop())},Ub=function(a,b){var c;fa||(qb=m);var d;if("swipe"===a){var g=kb.x-lb.x,h=b.lastFlickDist.x<10;g>fb&&(h||b.lastFlickOffset.x>20)?d=-1:g<-fb&&(h||b.lastFlickOffset.x<-20)&&(d=1)}var j;d&&(m+=d,m<0?(m=i.loop?ac()-1:0,j=!0):m>=ac()&&(m=i.loop?0:ac()-1,j=!0),j&&!i.loop||(ua+=d,ra-=d,c=!0));var k,l=ta.x*ra,n=Math.abs(l-tb.x);return c||l>tb.x==b.lastFlickSpeed.x>0?(k=Math.abs(b.lastFlickSpeed.x)>0?n/Math.abs(b.lastFlickSpeed.x):333,k=Math.min(k,400),k=Math.max(k,250)):k=333,qb===m&&(c=!1),fa=!0,Da("mainScrollAnimStart"),db("mainScroll",tb.x,l,k,e.easing.cubic.out,Ka,function(){cb(),fa=!1,qb=-1,(c||qb!==m)&&f.updateCurrItem(),Da("mainScrollAnimComplete")}),c&&f.updateCurrItem(!0),c},Vb=function(a){return 1/ca*a*t},Wb=function(){var a=s,b=Ta(),c=Ua();s<b?a=b:s>c&&(a=c);var d,g=1,h=ja;return ia&&!S&&!ka&&s<b?(f.close(),!0):(ia&&(d=function(a){Fa((g-h)*a+h)}),f.zoomTo(a,0,200,e.easing.cubic.out,d),!0)};za("Gestures",{publicMethods:{initGestures:function(){var a=function(a,b,c,d,e){A=a+b,B=a+c,C=a+d,D=e?a+e:""};F=N.pointerEvent,F&&N.touch&&(N.touch=!1),F?navigator.pointerEnabled?a("pointer","down","move","up","cancel"):a("MSPointer","Down","Move","Up","Cancel"):N.touch?(a("touch","start","move","end","cancel"),G=!0):a("mouse","down","move","up"),p=B+" "+C+" "+D,q=A,F&&!G&&(G=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1),f.likelyTouchDevice=G,r[A]=Ob,r[B]=Pb,r[C]=Rb,D&&(r[D]=r[C]),N.touch&&(q+=" mousedown",p+=" mousemove mouseup",r.mousedown=r[A],r.mousemove=r[B],r.mouseup=r[C]),G||(i.allowPanToNext=!1)}}});var Xb,Yb,Zb,$b,_b,ac,bc,cc=function(b,c,d,g){Xb&&clearTimeout(Xb),$b=!0,Zb=!0;var h;b.initialLayout?(h=b.initialLayout,b.initialLayout=null):h=i.getThumbBoundsFn&&i.getThumbBoundsFn(m);var j=d?i.hideAnimationDuration:i.showAnimationDuration,k=function(){ab("initialZoom"),d?(f.template.removeAttribute("style"),f.bg.removeAttribute("style")):(Fa(1),c&&(c.style.display="block"),e.addClass(a,"pswp--animated-in"),Da("initialZoom"+(d?"OutEnd":"InEnd"))),g&&g(),$b=!1};if(!j||!h||void 0===h.x)return Da("initialZoom"+(d?"Out":"In")),s=b.initialZoomLevel,Ma(pa,b.initialPosition),Ha(),a.style.opacity=d?0:1,Fa(1),void(j?setTimeout(function(){k()},j):k());var n=function(){var c=l,g=!f.currItem.src||f.currItem.loadError||i.showHideOpacity;b.miniImg&&(b.miniImg.style.webkitBackfaceVisibility="hidden"),d||(s=h.w/b.w,pa.x=h.x,pa.y=h.y-K,f[g?"template":"bg"].style.opacity=.001,Ha()),bb("initialZoom"),d&&!c&&e.removeClass(a,"pswp--animated-in"),g&&(d?e[(c?"remove":"add")+"Class"](a,"pswp--animate_opacity"):setTimeout(function(){e.addClass(a,"pswp--animate_opacity")},30)),Xb=setTimeout(function(){if(Da("initialZoom"+(d?"Out":"In")),d){var f=h.w/b.w,i={x:pa.x,y:pa.y},l=s,m=ja,n=function(b){1===b?(s=f,pa.x=h.x,pa.y=h.y-M):(s=(f-l)*b+l,pa.x=(h.x-i.x)*b+i.x,pa.y=(h.y-M-i.y)*b+i.y),Ha(),g?a.style.opacity=1-b:Fa(m-b*m)};c?db("initialZoom",0,1,j,e.easing.cubic.out,n,k):(n(1),Xb=setTimeout(k,j+20))}else s=b.initialZoomLevel,Ma(pa,b.initialPosition),Ha(),Fa(1),g?a.style.opacity=1:Fa(1),Xb=setTimeout(k,j+20)},d?25:90)};n()},dc={},ec=[],fc={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:!1,preload:[1,1],getNumItemsFn:function(){return Yb.length}},gc=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}}},hc=function(a,b,c){var d=a.bounds;d.center.x=Math.round((dc.x-b)/2),d.center.y=Math.round((dc.y-c)/2)+a.vGap.top,d.max.x=b>dc.x?Math.round(dc.x-b):d.center.x,d.max.y=c>dc.y?Math.round(dc.y-c)+a.vGap.top:d.center.y,d.min.x=b>dc.x?0:d.center.x,d.min.y=c>dc.y?a.vGap.top:d.center.y},ic=function(a,b,c){if(a.src&&!a.loadError){var d=!c;if(d&&(a.vGap||(a.vGap={top:0,bottom:0}),Da("parseVerticalMargin",a)),dc.x=b.x,dc.y=b.y-a.vGap.top-a.vGap.bottom,d){var e=dc.x/a.w,f=dc.y/a.h;a.fitRatio=e<f?e:f;var g=i.scaleMode;"orig"===g?c=1:"fit"===g&&(c=a.fitRatio),c>1&&(c=1),a.initialZoomLevel=c,a.bounds||(a.bounds=gc())}if(!c)return;return hc(a,a.w*c,a.h*c),d&&c===a.initialZoomLevel&&(a.initialPosition=a.bounds.center),a.bounds}return a.w=a.h=0,a.initialZoomLevel=a.fitRatio=1,a.bounds=gc(),a.initialPosition=a.bounds.center,a.bounds},jc=function(a,b,c,d,e,g){b.loadError||d&&(b.imageAppended=!0,mc(b,d,b===f.currItem&&ya),c.appendChild(d),g&&setTimeout(function(){b&&b.loaded&&b.placeholder&&(b.placeholder.style.display="none",b.placeholder=null)},500))},kc=function(a){a.loading=!0,a.loaded=!1;var b=a.img=e.createEl("pswp__img","img"),c=function(){a.loading=!1,a.loaded=!0,a.loadComplete?a.loadComplete(a):a.img=null,b.onload=b.onerror=null,b=null};return b.onload=c,b.onerror=function(){a.loadError=!0,c()},b.src=a.src,b},lc=function(a,b){if(a.src&&a.loadError&&a.container)return b&&(a.container.innerHTML=""),a.container.innerHTML=i.errorMsg.replace("%url%",a.src),!0},mc=function(a,b,c){if(a.src){b||(b=a.container.lastChild);var d=c?a.w:Math.round(a.w*a.fitRatio),e=c?a.h:Math.round(a.h*a.fitRatio);a.placeholder&&!a.loaded&&(a.placeholder.style.width=d+"px",a.placeholder.style.height=e+"px"),b.style.width=d+"px",b.style.height=e+"px"}},nc=function(){if(ec.length){for(var a,b=0;b<ec.length;b++)a=ec[b],a.holder.index===a.index&&jc(a.index,a.item,a.baseDiv,a.img,!1,a.clearPlaceholder);ec=[]}};za("Controller",{publicMethods:{lazyLoadItem:function(a){a=Aa(a);var b=_b(a);b&&(!b.loaded&&!b.loading||x)&&(Da("gettingData",a,b),b.src&&kc(b))},initController:function(){e.extend(i,fc,!0),f.items=Yb=c,_b=f.getItemAt,ac=i.getNumItemsFn,bc=i.loop,ac()<3&&(i.loop=!1),Ca("beforeChange",function(a){var b,c=i.preload,d=null===a||a>=0,e=Math.min(c[0],ac()),g=Math.min(c[1],ac());for(b=1;b<=(d?g:e);b++)f.lazyLoadItem(m+b);for(b=1;b<=(d?e:g);b++)f.lazyLoadItem(m-b)}),Ca("initialLayout",function(){f.currItem.initialLayout=i.getThumbBoundsFn&&i.getThumbBoundsFn(m)}),Ca("mainScrollAnimComplete",nc),Ca("initialZoomInEnd",nc),Ca("destroy",function(){for(var a,b=0;b<Yb.length;b++)a=Yb[b],a.container&&(a.container=null),a.placeholder&&(a.placeholder=null),a.img&&(a.img=null),a.preloader&&(a.preloader=null),a.loadError&&(a.loaded=a.loadError=!1);ec=null})},getItemAt:function(a){return a>=0&&(void 0!==Yb[a]&&Yb[a])},allowProgressiveImg:function(){return i.forceProgressiveLoading||!G||i.mouseUsed||screen.width>1200},setContent:function(a,b){i.loop&&(b=Aa(b));var c=f.getItemAt(a.index);c&&(c.container=null);var d,g=f.getItemAt(b);if(!g)return void(a.el.innerHTML="");Da("gettingData",b,g),a.index=b,a.item=g;var h=g.container=e.createEl("pswp__zoom-wrap");if(!g.src&&g.html&&(g.html.tagName?h.appendChild(g.html):h.innerHTML=g.html),lc(g),ic(g,qa),!g.src||g.loadError||g.loaded)g.src&&!g.loadError&&(d=e.createEl("pswp__img","img"),d.style.opacity=1,d.src=g.src,mc(g,d),jc(b,g,h,d,!0));else{if(g.loadComplete=function(c){if(j){if(a&&a.index===b){if(lc(c,!0))return c.loadComplete=c.img=null,ic(c,qa),Ia(c),void(a.index===m&&f.updateCurrZoomItem());c.imageAppended?!$b&&c.placeholder&&(c.placeholder.style.display="none",c.placeholder=null):N.transform&&(fa||$b)?ec.push({item:c,baseDiv:h,img:c.img,index:b,holder:a,clearPlaceholder:!0}):jc(b,c,h,c.img,fa||$b,!0)}c.loadComplete=null,c.img=null,Da("imageLoadComplete",b,c)}},e.features.transform){var k="pswp__img pswp__img--placeholder";k+=g.msrc?"":" pswp__img--placeholder--blank";var l=e.createEl(k,g.msrc?"img":"");g.msrc&&(l.src=g.msrc),mc(g,l),h.appendChild(l),g.placeholder=l}g.loading||kc(g),f.allowProgressiveImg()&&(!Zb&&N.transform?ec.push({item:g,baseDiv:h,img:g.img,index:b,holder:a}):jc(b,g,h,g.img,!0,!0))}Zb||b!==m?Ia(g):(ea=h.style,cc(g,d||g.img)),a.el.innerHTML="",a.el.appendChild(h)},cleanSlide:function(a){a.img&&(a.img.onload=a.img.onerror=null),a.loaded=a.loading=a.img=a.imageAppended=!1}}});var oc,pc={},qc=function(a,b,c){var d=document.createEvent("CustomEvent"),e={origEvent:a,target:a.target,releasePoint:b,pointerType:c||"touch"};d.initCustomEvent("pswpTap",!0,!0,e),a.target.dispatchEvent(d)};za("Tap",{publicMethods:{initTap:function(){Ca("firstTouchStart",f.onTapStart),Ca("touchRelease",f.onTapRelease),Ca("destroy",function(){pc={},oc=null})},onTapStart:function(a){a.length>1&&(clearTimeout(oc),oc=null)},onTapRelease:function(a,b){if(b&&!Y&&!W&&!_a){var c=b;if(oc&&(clearTimeout(oc),oc=null,xb(c,pc)))return void Da("doubleTap",c);if("mouse"===b.type)return void qc(a,b,"mouse");var d=a.target.tagName.toUpperCase();if("BUTTON"===d||e.hasClass(a.target,"pswp__single-tap"))return void qc(a,b);Ma(pc,c),oc=setTimeout(function(){qc(a,b),oc=null},300)}}}});var rc;za("DesktopZoom",{publicMethods:{initDesktopZoom:function(){L||(G?Ca("mouseUsed",function(){f.setupDesktopZoom()}):f.setupDesktopZoom(!0))},setupDesktopZoom:function(b){rc={};var c="wheel mousewheel DOMMouseScroll";Ca("bindEvents",function(){e.bind(a,c,f.handleMouseWheel)}),Ca("unbindEvents",function(){rc&&e.unbind(a,c,f.handleMouseWheel)}),f.mouseZoomedIn=!1;var d,g=function(){f.mouseZoomedIn&&(e.removeClass(a,"pswp--zoomed-in"),f.mouseZoomedIn=!1),s<1?e.addClass(a,"pswp--zoom-allowed"):e.removeClass(a,"pswp--zoom-allowed"),h()},h=function(){d&&(e.removeClass(a,"pswp--dragging"),d=!1)};Ca("resize",g),Ca("afterChange",g),Ca("pointerDown",function(){f.mouseZoomedIn&&(d=!0,e.addClass(a,"pswp--dragging"))}),Ca("pointerUp",h),b||g()},handleMouseWheel:function(a){if(s<=f.currItem.fitRatio)return i.modal&&(!i.closeOnScroll||_a||V?a.preventDefault():E&&Math.abs(a.deltaY)>2&&(l=!0,f.close())),!0;if(a.stopPropagation(),rc.x=0,"deltaX"in a)1===a.deltaMode?(rc.x=18*a.deltaX,rc.y=18*a.deltaY):(rc.x=a.deltaX,rc.y=a.deltaY);else if("wheelDelta"in a)a.wheelDeltaX&&(rc.x=-.16*a.wheelDeltaX),a.wheelDeltaY?rc.y=-.16*a.wheelDeltaY:rc.y=-.16*a.wheelDelta;else{if(!("detail"in a))return;rc.y=a.detail}Sa(s,!0);var b=pa.x-rc.x,c=pa.y-rc.y;(i.modal||b<=da.min.x&&b>=da.max.x&&c<=da.min.y&&c>=da.max.y)&&a.preventDefault(),f.panTo(b,c)},toggleDesktopZoom:function(b){b=b||{x:qa.x/2+sa.x,y:qa.y/2+sa.y};var c=i.getDoubleTapZoom(!0,f.currItem),d=s===c;f.mouseZoomedIn=!d,f.zoomTo(d?f.currItem.initialZoomLevel:c,b,333),e[(d?"remove":"add")+"Class"](a,"pswp--zoomed-in")}}});var sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc,Ec={history:!0,galleryUID:1},Fc=function(){return Cc.hash.substring(1)},Gc=function(){sc&&clearTimeout(sc),uc&&clearTimeout(uc)},Hc=function(){var a=Fc(),b={};if(a.length<5)return b;var c,d=a.split("&");for(c=0;c<d.length;c++)if(d[c]){var e=d[c].split("=");e.length<2||(b[e[0]]=e[1])}if(i.galleryPIDs){var f=b.pid;for(b.pid=0,c=0;c<Yb.length;c++)if(Yb[c].pid===f){b.pid=c;break}}else b.pid=parseInt(b.pid,10)-1;return b.pid<0&&(b.pid=0),b},Ic=function(){if(uc&&clearTimeout(uc),_a||V)return void(uc=setTimeout(Ic,500));vc?clearTimeout(tc):vc=!0;var a=m+1,b=_b(m);b.hasOwnProperty("pid")&&(a=b.pid);var c=yc+"&gid="+i.galleryUID+"&pid="+a;zc||Cc.hash.indexOf(c)===-1&&(Bc=!0);var d=Cc.href.split("#")[0]+"#"+c;Dc?"#"+c!==window.location.hash&&history[zc?"replaceState":"pushState"]("",document.title,d):zc?Cc.replace(d):Cc.hash=c,zc=!0,tc=setTimeout(function(){vc=!1},60)};za("History",{publicMethods:{initHistory:function(){if(e.extend(i,Ec,!0),i.history){Cc=window.location,Bc=!1,Ac=!1,zc=!1,yc=Fc(),Dc="pushState"in history,yc.indexOf("gid=")>-1&&(yc=yc.split("&gid=")[0],yc=yc.split("?gid=")[0]),Ca("afterChange",f.updateURL),Ca("unbindEvents",function(){e.unbind(window,"hashchange",f.onHashChange)});var a=function(){xc=!0,Ac||(Bc?history.back():yc?Cc.hash=yc:Dc?history.pushState("",document.title,Cc.pathname+Cc.search):Cc.hash=""),Gc()};Ca("unbindEvents",function(){l&&a()}),Ca("destroy",function(){xc||a()}),Ca("firstUpdate",function(){m=Hc().pid});var b=yc.indexOf("pid=");b>-1&&(yc=yc.substring(0,b),"&"===yc.slice(-1)&&(yc=yc.slice(0,-1))),setTimeout(function(){j&&e.bind(window,"hashchange",f.onHashChange)},40)}},onHashChange:function(){return Fc()===yc?(Ac=!0,void f.close()):void(vc||(wc=!0,f.goTo(Hc().pid),wc=!1))},updateURL:function(){Gc(),wc||(zc?sc=setTimeout(Ic,800):Ic())}}}),e.extend(f,eb)};return a});!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.PhotoSwipeUI_Default=b()}(this,function(){"use strict";var a=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w=!1,x=!0,y=!0,z={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(a,b){return a.title?(b.children[0].innerHTML=a.title,!0):(b.children[0].innerHTML="",!1)},closeEl:!0,captionEl:!0,fullscreenEl:!0,zoomEl:!0,shareEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}],getImageURLForShare:function(){return a.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return a.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},A=function(a){if(r)return!0;a=a||window.event,q.timeToIdle&&q.mouseUsed&&!k&&K();for(var c,d,e=a.target||a.srcElement,f=e.getAttribute("class")||"",g=0;g<S.length;g++)c=S[g],c.onTap&&f.indexOf("pswp__"+c.name)>-1&&(c.onTap(),d=!0);if(d){a.stopPropagation&&a.stopPropagation(),r=!0;var h=b.features.isOldAndroid?600:30;s=setTimeout(function(){r=!1},h)}},B=function(){return!a.likelyTouchDevice||q.mouseUsed||screen.width>q.fitControlsWidth},C=function(a,c,d){b[(d?"add":"remove")+"Class"](a,"pswp__"+c)},D=function(){var a=1===q.getNumItemsFn();a!==p&&(C(d,"ui--one-slide",a),p=a)},E=function(){C(i,"share-modal--hidden",y)},F=function(){return y=!y,y?(b.removeClass(i,"pswp__share-modal--fade-in"),setTimeout(function(){y&&E()},300)):(E(),setTimeout(function(){y||b.addClass(i,"pswp__share-modal--fade-in")},30)),y||H(),!1},G=function(b){b=b||window.event;var c=b.target||b.srcElement;return a.shout("shareLinkClick",b,c),!!c.href&&(!!c.hasAttribute("download")||(window.open(c.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100)),y||F(),!1))},H=function(){for(var a,b,c,d,e,f="",g=0;g<q.shareButtons.length;g++)a=q.shareButtons[g],c=q.getImageURLForShare(a),d=q.getPageURLForShare(a),e=q.getTextForShare(a),b=a.url.replace("{{url}}",encodeURIComponent(d)).replace("{{image_url}}",encodeURIComponent(c)).replace("{{raw_image_url}}",c).replace("{{text}}",encodeURIComponent(e)),f+='<a href="'+b+'" target="_blank" class="pswp__share--'+a.id+'"'+(a.download?"download":"")+">"+a.label+"</a>",q.parseShareButtonOut&&(f=q.parseShareButtonOut(a,f));i.children[0].innerHTML=f,i.children[0].onclick=G},I=function(a){for(var c=0;c<q.closeElClasses.length;c++)if(b.hasClass(a,"pswp__"+q.closeElClasses[c]))return!0},J=0,K=function(){clearTimeout(u),J=0,k&&v.setIdle(!1)},L=function(a){a=a?a:window.event;var b=a.relatedTarget||a.toElement;b&&"HTML"!==b.nodeName||(clearTimeout(u),u=setTimeout(function(){v.setIdle(!0)},q.timeToIdleOutside))},M=function(){q.fullscreenEl&&!b.features.isOldAndroid&&(c||(c=v.getFullscreenAPI()),c?(b.bind(document,c.eventK,v.updateFullscreen),v.updateFullscreen(),b.addClass(a.template,"pswp--supports-fs")):b.removeClass(a.template,"pswp--supports-fs"))},N=function(){q.preloaderEl&&(O(!0),l("beforeChange",function(){clearTimeout(o),o=setTimeout(function(){a.currItem&&a.currItem.loading?(!a.allowProgressiveImg()||a.currItem.img&&!a.currItem.img.naturalWidth)&&O(!1):O(!0)},q.loadingIndicatorDelay)}),l("imageLoadComplete",function(b,c){a.currItem===c&&O(!0)}))},O=function(a){n!==a&&(C(m,"preloader--active",!a),n=a)},P=function(a){var c=a.vGap;if(B()){var g=q.barsSize;if(q.captionEl&&"auto"===g.bottom)if(f||(f=b.createEl("pswp__caption pswp__caption--fake"),f.appendChild(b.createEl("pswp__caption__center")),d.insertBefore(f,e),b.addClass(d,"pswp__ui--fit")),q.addCaptionHTMLFn(a,f,!0)){var h=f.clientHeight;c.bottom=parseInt(h,10)||44}else c.bottom=g.top;else c.bottom="auto"===g.bottom?0:g.bottom;c.top=g.top}else c.top=c.bottom=0},Q=function(){q.timeToIdle&&l("mouseUsed",function(){b.bind(document,"mousemove",K),b.bind(document,"mouseout",L),t=setInterval(function(){J++,2===J&&v.setIdle(!0)},q.timeToIdle/2)})},R=function(){l("onVerticalDrag",function(a){x&&a<.95?v.hideControls():!x&&a>=.95&&v.showControls()});var a;l("onPinchClose",function(b){x&&b<.9?(v.hideControls(),a=!0):a&&!x&&b>.9&&v.showControls()}),l("zoomGestureEnded",function(){a=!1,a&&!x&&v.showControls()})},S=[{name:"caption",option:"captionEl",onInit:function(a){e=a}},{name:"share-modal",option:"shareEl",onInit:function(a){i=a},onTap:function(){F()}},{name:"button--share",option:"shareEl",onInit:function(a){h=a},onTap:function(){F()}},{name:"button--zoom",option:"zoomEl",onTap:a.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(a){g=a}},{name:"button--close",option:"closeEl",onTap:a.close},{name:"button--arrow--left",option:"arrowEl",onTap:a.prev},{name:"button--arrow--right",option:"arrowEl",onTap:a.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){c.isFullscreen()?c.exit():c.enter()}},{name:"preloader",option:"preloaderEl",onInit:function(a){m=a}}],T=function(){var a,c,e,f=function(d){if(d)for(var f=d.length,g=0;g<f;g++){a=d[g],c=a.className;for(var h=0;h<S.length;h++)e=S[h],c.indexOf("pswp__"+e.name)>-1&&(q[e.option]?(b.removeClass(a,"pswp__element--disabled"),e.onInit&&e.onInit(a)):b.addClass(a,"pswp__element--disabled"))}};f(d.children);var g=b.getChildByClass(d,"pswp__top-bar");g&&f(g.children)};v.init=function(){b.extend(a.options,z,!0),q=a.options,d=b.getChildByClass(a.scrollWrap,"pswp__ui"),l=a.listen,R(),l("beforeChange",v.update),l("doubleTap",function(b){var c=a.currItem.initialZoomLevel;a.getZoomLevel()!==c?a.zoomTo(c,b,333):a.zoomTo(q.getDoubleTapZoom(!1,a.currItem),b,333)}),l("preventDragEvent",function(a,b,c){var d=a.target||a.srcElement;d&&d.getAttribute("class")&&a.type.indexOf("mouse")>-1&&(d.getAttribute("class").indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(d.tagName))&&(c.prevent=!1)}),l("bindEvents",function(){b.bind(d,"pswpTap click",A),b.bind(a.scrollWrap,"pswpTap",v.onGlobalTap),a.likelyTouchDevice||b.bind(a.scrollWrap,"mouseover",v.onMouseOver)}),l("unbindEvents",function(){y||F(),t&&clearInterval(t),b.unbind(document,"mouseout",L),b.unbind(document,"mousemove",K),b.unbind(d,"pswpTap click",A),b.unbind(a.scrollWrap,"pswpTap",v.onGlobalTap),b.unbind(a.scrollWrap,"mouseover",v.onMouseOver),c&&(b.unbind(document,c.eventK,v.updateFullscreen),c.isFullscreen()&&(q.hideAnimationDuration=0,c.exit()),c=null)}),l("destroy",function(){q.captionEl&&(f&&d.removeChild(f),b.removeClass(e,"pswp__caption--empty")),i&&(i.children[0].onclick=null),b.removeClass(d,"pswp__ui--over-close"),b.addClass(d,"pswp__ui--hidden"),v.setIdle(!1)}),q.showAnimationDuration||b.removeClass(d,"pswp__ui--hidden"),l("initialZoomIn",function(){q.showAnimationDuration&&b.removeClass(d,"pswp__ui--hidden")}),l("initialZoomOut",function(){b.addClass(d,"pswp__ui--hidden")}),l("parseVerticalMargin",P),T(),q.shareEl&&h&&i&&(y=!0),D(),Q(),M(),N()},v.setIdle=function(a){k=a,C(d,"ui--idle",a)},v.update=function(){x&&a.currItem?(v.updateIndexIndicator(),q.captionEl&&(q.addCaptionHTMLFn(a.currItem,e),C(e,"caption--empty",!a.currItem.title)),w=!0):w=!1,y||F(),D()},v.updateFullscreen=function(d){d&&setTimeout(function(){a.setScrollOffset(0,b.getScrollY())},50),b[(c.isFullscreen()?"add":"remove")+"Class"](a.template,"pswp--fs")},v.updateIndexIndicator=function(){q.counterEl&&(g.innerHTML=a.getCurrentIndex()+1+q.indexIndicatorSep+q.getNumItemsFn())},v.onGlobalTap=function(c){c=c||window.event;var d=c.target||c.srcElement;if(!r)if(c.detail&&"mouse"===c.detail.pointerType){if(I(d))return void a.close();b.hasClass(d,"pswp__img")&&(1===a.getZoomLevel()&&a.getZoomLevel()<=a.currItem.fitRatio?q.clickToCloseNonZoomable&&a.close():a.toggleDesktopZoom(c.detail.releasePoint))}else if(q.tapToToggleControls&&(x?v.hideControls():v.showControls()),q.tapToClose&&(b.hasClass(d,"pswp__img")||I(d)))return void a.close()},v.onMouseOver=function(a){a=a||window.event;var b=a.target||a.srcElement;C(d,"ui--over-close",I(b))},v.hideControls=function(){b.addClass(d,"pswp__ui--hidden"),x=!1},v.showControls=function(){x=!0,w||v.update(),b.removeClass(d,"pswp__ui--hidden")},v.supportsFullscreen=function(){var a=document;return!!(a.exitFullscreen||a.mozCancelFullScreen||a.webkitExitFullscreen||a.msExitFullscreen)},v.getFullscreenAPI=function(){var b,c=document.documentElement,d="fullscreenchange";return c.requestFullscreen?b={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:d}:c.mozRequestFullScreen?b={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+d}:c.webkitRequestFullscreen?b={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+d}:c.msRequestFullscreen&&(b={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),b&&(b.enter=function(){return j=q.closeOnScroll,q.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK?a.template[this.enterK]():void a.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},b.exit=function(){return q.closeOnScroll=j,document[this.exitK]()},b.isFullscreen=function(){return document[this.elementK]}),b}};return a});var FacebookTools={Ready:false,Init:function(){FacebookTools.Ready=true;},AuthComplete:function(fn_success,fn_error){FB.getLoginStatus(function(response){if(typeof(response.status)=='undefined'||response.status=='unknown'){if(typeof(fn_error)=='function')fn_error('Для авторизації через Facebook потрібно увімкнути "3rd party cookies" у налаштуваннях браузера');return;}else if(response.status=='connected'&&typeof(response.authResponse)=='object'&&typeof(response.authResponse.accessToken)=='string'){$.ajax({url:'/ajax2/login.php',type:'post',dataType:'text',data:{fb_access_token:response.authResponse.accessToken},success:function(r){if(r=='OK'){if(typeof(fn_success)=='function'){fn_success('Авторизація успішна');return;}else{location.reload();}}else{if(typeof(fn_error)=='function'){fn_error(r);return;}else{alert(r);}}}});}else{if(typeof(fn_error)=='function')fn_error('Помилка авторизації через Facebook');return;}});}};var DesktopLogin={DOM:{},MessageTimeout:0,Form:function(){var html='<div class="dialog-login-form" style="padding: 4px;">'+'<div class="message dialog-login-message" style="display: none; margin-bottom: 10px;"></div>'+'<table cellspacing="3" cellpadding="0" border="0" style="margin: 6px auto 0 auto; padding: 0;">'+'<tr><td style="text-align:right; font-weight:bold; padding-right:4px;">Нік</td><td><input name="login" type="text" maxlength="20" class="make-focus" style="width:180px" /></td></tr>'+'<tr><td style="text-align:right; font-weight:bold; padding-right:4px;">Пароль</td><td><input name="password" type="password" maxlength="20" style="width:180px" /></td></tr>'+'</table>'+'<p style="text-align:center; font-size:13px; padding: 12px 0 6px 0;"><a href="//poltava.to/registration/" rel="nofollow">Реєстрація</a> | <a href="//poltava.to/registration/restore/" rel="nofollow">Забули пароль?</a></p>'+'</div>';html+='<div id="fb-dialog-auth" style="text-align: center; margin: 5px 0 15px 0;"><div class="fb-login-button" data-width="" data-size="medium" data-button-type="continue_with" data-auto-logout-link="false" data-use-continue-as="true" data-onlogin="DesktopLogin.FacebookAuthComplete();"></div></div>';return html;},OpenDialog:function(text){if(typeof(Template)!='undefined'&&Template.IsMobile==true){location.href='//poltava.to/login/';return false;}Dialog.Open({title:'Авторизація на сайті',content:DesktopLogin.Form(),width:'320px',action:'#',method:'post',extend_class:'',onready:DesktopLogin.OnReady,onsubmit:DesktopLogin.OnSubmit,onclose:DesktopLogin.OnClose,buttons:[{type:'submit',value:'Увійти',extend_class:''}]});FB.XFBML.parse(document.getElementById('tmp123'));return false;},OnReady:function(){DesktopLogin.DOM.FormPanel=Dialog.DOM.Holder.find('div.dialog-login-form');DesktopLogin.DOM.Message=Dialog.DOM.Holder.find('div.dialog-login-message');DesktopLogin.DOM.Login=Dialog.DOM.Holder.find('input[name=login]');DesktopLogin.DOM.Password=Dialog.DOM.Holder.find('input[name=password]');DesktopLogin.DOM.SubmitButton=Dialog.DOM.Holder.find('input[type=submit]');DesktopLogin.Active=true;},OnSubmit:function(){DesktopLogin.ButtonStatus(false);DesktopLogin.HideMessage();$.ajax({url:'/ajax2/login.php',type:'post',dataType:'text',data:{login:DesktopLogin.DOM.Login.val(),password:DesktopLogin.DOM.Password.val()},success:DesktopLogin.Complete,error:DesktopLogin.Error});return false;},Complete:function(response){if(response=='OK'){DesktopLogin.ShowMessage('Вітаємо вас на сайті!',0,'success');setTimeout(function(){location.reload();},1000);}else{DesktopLogin.ShowMessage(response);DesktopLogin.ButtonStatus(true);}},Error:function(){DesktopLogin.ShowMessage('Відсутній зв’язок з сервером.<br />Перевірте підключення до інтернету.');DesktopLogin.ButtonStatus(true);},OnClose:function(){DesktopLogin.Active=false;},ShowMessage:function(msg,time,msg_class){if(typeof(time)=='undefined')time=7000;if(DesktopLogin.MessageTimeout>0)clearTimeout(DesktopLogin.MessageTimeout);if(typeof(msg_class)=='undefined'||!(msg_class=='success'||msg_class=='error'))msg_class='error';DesktopLogin.DOM.Message.removeClass('error').removeClass('success').addClass(msg_class).html(msg).fadeIn();if(typeof(time)!='undefined'&&time>0)setTimeout(DesktopLogin.HideMessage,time);},HideMessage:function(){DesktopLogin.DOM.Message.fadeOut();},ButtonStatus:function(status){if(status==true)DesktopLogin.DOM.SubmitButton.removeAttr('disabled').val('Увійти');else DesktopLogin.DOM.SubmitButton.attr('disabled','disabled').val('Авторизація ...');},FacebookAuthComplete:function(){FacebookTools.AuthComplete(DesktopLogin.FacebookAuthSuccess,DesktopLogin.FacebookAuthError);},FacebookAuthSuccess:function(msg){$('#fb-dialog-auth').remove();DesktopLogin.ShowMessage(msg,10000,'success');setTimeout(function(){location.reload()},1000);},FacebookAuthError:function(msg){$('#fb-dialog-auth').remove();DesktopLogin.ShowMessage(msg,10000,'error');}};var Template={UserName:'',UserID:0,IsMobile:true,PageDT:'',PageTS:0,WindowWidth:0,ContentHeight:0,MinHeight:0,ResizeList:[],DOM:{},Init:function(){Template.GetDT();Template.ReplaceEmails();Template.InitHeaderTools();Template.DOM.Content=$('.template-content');if(Template.DOM.Content.length==1)Template.MinHeight=parseInt(Template.DOM.Content.attr('data-min-height'));Template.FooterLinks();Template.OnResize();$(window).resize(Template.OnResize);},GetDT:function(){var $body=$('body');var dt=$body.attr('data-dt');if(typeof(dt)!='undefined')Template.PageDT=dt;var ts=$body.attr('data-ts');if(typeof(ts)!='undefined')Template.PageTS=parseInt(ts,10);},InitHeaderTools:function(){Template.DOM.DesktopHeaderTools=$('.desktop-header-tools');var $username=Template.DOM.DesktopHeaderTools.find('#username');if($username.length==1){Template.UserName=$.trim($username.text());Template.UserID=parseInt($username.attr('data-id'),10);}if(Template.UserID==0){var $login=$('<a href="//poltava.to/login/">Вхід</a>');Template.DOM.DesktopHeaderTools.find('.float-right').append($login,'&nbsp;|&nbsp;','<a href="//poltava.to/registration/">Реєстрація</a>');if(typeof(DesktopLogin)!='undefined')$login.bind('click',DesktopLogin.OpenDialog);}else{var inbox_badge='';var inbox_count=parseInt($username.attr('data-inbox'),10);if(inbox_count>0)inbox_badge+=':&nbsp;<strong>'+inbox_count+'</strong>';Template.DOM.DesktopHeaderTools.find('.float-left').append('<a href="//poltava.to/my/comments/">Мої коментарі</a>','&nbsp;|&nbsp;','<a href="//poltava.to/my/inbox/">Мій інбокс</a>'+inbox_badge,'&nbsp;|&nbsp;');}Template.DOM.DesktopHeaderTools.find('.float-left').append('<a href="//poltava.to/tema/">Запропонувати тему</a>');},TestInterval:function(dt1,dt2){var dt=Template.PageDT;if(dt==''||dt1==''||dt2=='')return false;if(dt1<=dt&&dt<=dt2)return true;return false;},ReplaceEmails:function(){$('.template-email').each(function(){var $this=$(this);var email=$this.attr('data-email').replace(/\[at\]/,'@');var $a=$('<a></a>').attr('href','mailto:'+email).text(email);$this.html($a);})},FooterLinks:function(){$target=$('#footer-social');$target.append('<p class="footer-fb">А ви знаєте, що у «Полтавщини» є <a href="https://www.facebook.com/poltava.news">дуже цікава сторінка у Facebook</a>? Радимо підписатися, адже там&nbsp;є&nbsp;багато такого, що&nbsp;не&nbsp;публікується на&nbsp;сайті.</p>');$target.append('<p class="footer-telegram">А ще ми нещодавно створили <a href="https://t.me/poltava">чат Полтави у Telegram</a>, у&nbsp;якому&nbsp;полтавці діляться цікавими новинами та обговорюють проблеми міста.</p>');},GetRGB:function(color){var result;if(color&&color.constructor==Array&&color.length==3)return color;if(result=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color))return[parseInt(result[1]),parseInt(result[2]),parseInt(result[3])];if(result=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(color))return[parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55];if(result=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color))return[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)];if(result=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color))return[parseInt(result[1]+result[1],16),parseInt(result[2]+result[2],16),parseInt(result[3]+result[3],16)];return[jQuery.trim(color).toLowerCase()];},Opacity:function(colors,opacity){var o_color=[];for(i in colors){var color=colors[i];o_color[i]=Math.round(255*(1-opacity)+color*opacity);}return o_color;},AddResize:function(fn,priority){Template.ResizeList.push({fn:fn,priority:priority});Template.ResizeList.sort(function(a,b){return a.priority-b.priority;});},UpdateContentHeight:function(){if(Template.DOM.Content.length==1)Template.ContentHeight=Math.ceil(parseFloat(Template.DOM.Content.height()));},OnResize:function(){Template.WindowWidth=$(window).width();Template.IsMobile=Template.WindowWidth<=919?true:false;$.each(Template.ResizeList,function(index,value){Template.UpdateContentHeight();value.fn();});Template.UpdateContentHeight();}};$(Template.Init);var ContentMedia={DOM:{},Images:[],Gallery:null,Init:function(){ContentMedia.DOM.ContentBlocks=$('.content');ContentMedia.DOM.ContentBlocks.find('img').each(ContentMedia.ProcessImage);if(ContentMedia.Images.length>0){ContentMedia.InitViewer();ContentMedia.DOM.ContentBlocks.find('a.media-link').on('click',ContentMedia.OpenViewer);}},InitViewer:function(){var html='<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">'+'    <div class="pswp__bg"></div>'+'    <div class="pswp__scroll-wrap">'+'        <div class="pswp__container">'+'            <div class="pswp__item"></div>'+'            <div class="pswp__item"></div>'+'            <div class="pswp__item"></div>'+'        </div>'+'        <div class="pswp__ui pswp__ui--hidden">'+'            <div class="pswp__top-bar">'+'                <div class="pswp__counter"></div>'+'                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>'+'                <button class="pswp__button pswp__button--share" title="Share"></button>'+'                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>'+'                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>'+'                <div class="pswp__preloader">'+'                    <div class="pswp__preloader__icn">'+'                      <div class="pswp__preloader__cut">'+'                        <div class="pswp__preloader__donut"></div>'+'                      </div>'+'                    </div>'+'                </div>'+'            </div>'+'            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">'+'                <div class="pswp__share-tooltip"></div>'+'            </div>'+'            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>'+'            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>'+'            <div class="pswp__caption">'+'                <div class="pswp__caption__center"></div>'+'            </div>'+'        </div>'+'    </div>'+'</div>';$('body').append(html);},InitTopMedia:function(){ContentMedia.DOM.TopMedia=ContentMedia.DOM.ContentBlocks.find('.top-media');if(ContentMedia.DOM.TopMedia.length!=1)return;var $img=ContentMedia.DOM.TopMedia.find('img');if($img.length!=1)return;var color=Template.GetRGB(ContentMedia.DOM.TopMedia.attr('data-color'));var color_in=Template.Opacity(color,0.5);var color_out=Template.Opacity(color,0.25);var $bg_out=$('<span class="top-media-out"></span>').css('background-color','rgb('+color_out+')');var $bg_in=$('<span class="top-media-in"></span>').css('background-color','rgb('+color_in+')');$img.wrap($bg_out);$img.wrap($bg_in);ContentMedia.DOM.TopMediaOut=ContentMedia.DOM.TopMedia.find('.top-media-out');ContentMedia.DOM.TopMediaIn=ContentMedia.DOM.TopMedia.find('.top-media-in');},ProcessImage:function(){var $img=$(this);if($img.hasClass('no-viewer'))return;if(typeof($img.attr('width'))=='undefined'||typeof($img.attr('height'))=='undefined')return;if(typeof($img.attr('data-poll'))!='undefined')return;var width=parseInt($img.attr('width'),10);var height=parseInt($img.attr('height'),10);if(!(width>0&&height>0))return;var full_width=typeof($img.attr('data-width'))!='undefined'?parseInt($img.attr('data-width'),10):width;var full_height=typeof($img.attr('data-height'))!='undefined'?parseInt($img.attr('data-height'),10):height;if(typeof($img.attr('data-video'))!='undefined'){var k=Math.round(100*full_height/full_width);var $iframe=$('<iframe frameborder="no" allowfullscreen></iframe>').attr({'src':$img.attr('data-video')});var $div1=$('<div class="media-iframe"></div>');var $div2=$('<div></div>').css('padding-bottom',k+'%');$img.replaceWith($div1.append($div2.append($iframe)));}else{var img_src=$img.attr('src');if(typeof($img.attr('data-fullsize'))!='undefined'&&$img.attr('data-fullsize')!='')img_src=$img.attr('data-fullsize');var $img_holder=$img.closest('p,td,th,li,div');var title=$.trim($img_holder.text());var $img_holder_parent=$img_holder.parent();if(title==''&&$img_holder_parent.hasClass('photo')){var $description=$img_holder_parent.find('.description').clone();$description.find('.wym-photo-description').remove();title=$.trim($description.text());}else{var alt=$img.attr('alt');if(alt!='')title=alt;}var image={index:ContentMedia.Images.length,src:img_src,w:full_width,h:full_height,title:title};ContentMedia.Images.push(image);var $parent_link=$img.parents('a');if($parent_link.hasClass('media-link'))return;if($parent_link.length==1)$parent_link.css('display','block');var use_viewer=$parent_link.length==0?true:false;var href=use_viewer?img_src:$parent_link.attr('href');$a=$('<a class="media-link"></a>');$a.attr({'href':href,'data-index':image.index,'data-viewer':(use_viewer?1:0)});$img.wrap($a);}},OpenViewer:function(){var $a=$(this);if($a.attr('data-viewer')==0)return;var image_index=parseInt($a.attr('data-index'));var pswpElement=document.querySelectorAll('.pswp')[0];var options={index:image_index,bgOpacity:0.85,closeOnScroll:false,shareEl:false,history:false};ContentMedia.Gallery=new PhotoSwipe(pswpElement,PhotoSwipeUI_Default,ContentMedia.Images,options);ContentMedia.Gallery.init();return false;}};$(ContentMedia.Init);var BC3={Path:'//i1.poltava.to',Index:[],Bnrs:{},DOM:{},SidebarOffset:0,SidebarMatrix:[],Init:function(){if(typeof(bn_data)=='undefined'||typeof(bn_code)=='undefined')return;BC3.DOM.Sidebar=$('.template-sidebar');BC3.LoadConfig();Template.AddResize(BC3.OnResize,100);Template.OnResize();$(window).bind('scroll',BC3.OnScroll);BC3.OnScroll();},LoadConfig:function(){var places=['top','right','bottom'];var limits={top:1,right:BC3.DOM.Sidebar.find('.bn-sidebar').length,bottom:1};var count={top:0,right:0,bottom:0};var using=[];var free=[];try{var data=$.parseJSON($.base64.atob(bn_data,true));for(var config_code in data.c){if(!data.c[config_code])continue;for(var key in places){var place=places[key];if(typeof(data.c[config_code][place])=='undefined')continue;var conf=BC3.ParseConfig(data.c[config_code][place]);for(var i in conf){var bnr_id=conf[i];if(typeof(data.b[bnr_id])=='undefined')continue;var bnr=BC3.ProcessBn(data.b[bnr_id]);bnr.place=place;BC3.Bnrs[bnr_id]=bnr;if(config_code==bn_code){using.push(bnr_id);count[place]++;}else{free.push(bnr_id);}}}}}catch(e){console.log(e);return;}BC3.Shuffle(using);BC3.Shuffle(free);using.sort(BC3.ValueSort);free.sort(BC3.ValueSort);BC3.Index=using;var need={};for(var place in count)need[place]=limits[place]-count[place];for(var i in free){var bnr=BC3.Bnrs[free[i]];if(!bnr)continue;if(!need[bnr.place])continue;BC3.Index.push(parseInt(bnr.id,10));need[bnr.place]--;}},ProcessBn:function(bn){bn.width=parseInt(bn.width,10);bn.height=parseInt(bn.height,10);bn.test=':)';var text_fields=['url','img','html5','mobile_url','mobile_img','mobile_html5'];var int_fields=['width','height','mobile_width','mobile_height'];for(var i in text_fields){var field=text_fields[i];if(typeof(bn[field])=='undefined')bn[field]='';}for(var i in int_fields){var field=int_fields[i];if(typeof(bn[field])=='undefined')bn[field]=0;}return bn;},ParseConfig:function(str){if(str=='')return[];var reBrackets=/^\(([\d|]+)\)(!?)$/;var tmp1=str.split(',');var list1=[];for(i in tmp1){if(reBrackets.test(tmp1[i])){var fix_sign=RegExp.$2=='!'?'!':'';var tmp2=RegExp.$1.split('|');var tmp3=[];for(j=0;j<tmp2.length;j++){tmp3.push(tmp2[j]);}if(tmp3.length>0){BC3.Shuffle(tmp3);list1.push(tmp3[0]+fix_sign);}}else{list1.push(tmp1[i]);}}tmp1=[];tmp2=[];for(i in list1){if(list1[i].indexOf('!')==-1){tmp1.push(i);tmp2.push(list1[i]);}}BC3.Shuffle(tmp2);for(i in tmp2){var ii=tmp1[i];list1[ii]=tmp2[i];}for(i in list1)list1[i]=parseInt(list1[i]);return list1;},ValueSort:function(a,b){var v1=Math.random()*BC3.ValueC(a);var v2=Math.random()*BC3.ValueC(b);return v2-v1;},ValueC:function(bnr_id){if(typeof(BC3.Bnrs[bnr_id])!='undefined'){var bnr=BC3.Bnrs[bnr_id];switch(bnr.place){case'top':return 1.125;case'bottom':return 0.875;}}return 1;},Shuffle:function(array){if(typeof(array)=='undefined')return;var i=0,j=0,temp=null;for(i=array.length-1;i>0;i-=1){j=Math.floor(Math.random()*(i+1));temp=array[i];array[i]=array[j];array[j]=temp;}},UpdateSidebarMatrix:function(){BC3.SidebarMatrix=[];BC3.DOM.SidebarBnrs=BC3.DOM.Sidebar.children('.bn-sidebar');if(BC3.DOM.SidebarBnrs.length==0)return;var gap=10;var heights=[];var column_height=0;var offsets=[];var not_empty_count=0;BC3.DOM.SidebarBnrs.each(function(){var $bnr=$(this);if($bnr.hasClass('bn-not-used')){heights.push(0);offsets.push(0);}else{var bnr_height=$bnr.height();var relative_top=parseInt($bnr.css('top'));if(isNaN(relative_top))relative_top=0;base_offset=$bnr.offset().top-relative_top-BC3.SidebarOffset;heights.push(bnr_height);offsets.push(base_offset);not_empty_count++;column_height=base_offset+bnr_height;}});if(not_empty_count==0)return;var content_height=Math.max(Template.ContentHeight,column_height);BC3.DOM.Sidebar.css('min-height',content_height+'px');var offset=0;var bnr_index=0;var first_loop=true;$loops=0;while(true){if(++$loops>100)break;if(bnr_index>=heights.length){bnr_index=0;first_loop=false;}var h=heights[bnr_index];if(h==0){bnr_index++;continue;}if(first_loop)offset=offsets[bnr_index];if(offset+h>content_height)break;BC3.SidebarMatrix.push({top:offset,bottom:offset+h,index:bnr_index,base_offset:offsets[bnr_index]});offset+=h+gap;bnr_index++;}},OnResize:function(){BC3.Update();if(Template.IsMobile==false){BC3.SidebarOffset=parseInt(BC3.DOM.Sidebar.offset().top);BC3.UpdateSidebarMatrix();}BC3.OnScroll();},Update:function(){BC3.DOM.Places=$('.bn');BC3.DOM.Places.removeClass('bn-not-used');for(var i in BC3.Bnrs)BC3.Bnrs[i].using=false;BC3.DOM.Places.each(function(){var $bnr_place=$(this);if($bnr_place.is(':visible')){var bnr_width=$bnr_place.width();var need_width=0;var blocks_width=0;var blocks_count=0;$bnr_place.find('.block').each(function(){var $block=$(this);blocks_width+=Math.ceil($block.width());blocks_count++;});if(blocks_count>0)need_width=blocks_width+(blocks_count-1)*10;if(bnr_width<need_width){BC3.Empty($bnr_place);}else{if(typeof($bnr_place.attr('data-bnr'))!='undefined'){var id=$bnr_place.attr('data-bnr').split(',');if(id.length>0){for(var i in id){var bnr_id=parseInt(id[i]);if(typeof(BC3.Bnrs[bnr_id])!='undefined')BC3.Bnrs[bnr_id].using=true;}}}else{BC3.Empty($bnr_place);}}}else{BC3.Empty($bnr_place);}});BC3.DOM.Places.filter(':visible').each(function(){BC3.Fill($(this));});},Empty:function($bnr_place){$bnr_place.empty().attr('data-bnr','');},Fill:function($bnr_place){if(typeof($bnr_place.attr('data-bnr'))!='undefined'&&$bnr_place.attr('data-bnr')!='')return;var place_width=Math.ceil($bnr_place.width());var free_width=place_width;var place=typeof($bnr_place.attr('data-place'))!='undefined'?$bnr_place.attr('data-place'):'';var bnrs=[];for(var i in BC3.Index){var bnr_id=BC3.Index[i];var bnr=BC3.Bnrs[bnr_id];if(bnr.using)continue;if(place!=''&&bnr.place!=place)continue;var space=bnrs.length>0?(bnrs.length>1?10:15):0;var bnr_width=bnr.width;if(bnr_width<=free_width-space){bnr.using=true;bnr.mode='desktop';bnrs.push(bnr);free_width-=bnr_width+space;}else{if(bnr.mobile_width>0&&bnr.mobile_width<=free_width-space){bnr.using=true;bnr.mode='mobile';bnrs.push(bnr);free_width-=bnr.mobile_width+space;}}if(free_width<300||bnrs.length==2)break;}$bnr_place.empty();if(bnrs.length>0)BC3.Dispose($bnr_place,bnrs);else $bnr_place.addClass('bn-not-used');},Make:function(bnr){var $bnr=$('<div class="block"></div>');var $media='';if(bnr.mode=='desktop'){if(bnr.html5!=''){$media=$(document.createElement('iframe')).attr({'src':BC3.Path+bnr.html5,'frameborder':0,'scrolling':'no'});}else if(bnr.img!=''){var $media=$(document.createElement('img')).attr('src',BC3.Path+bnr.img);}}else if(bnr.mode=='mobile'){if(bnr.mobile_html5!=''){$media=$(document.createElement('iframe')).attr({'src':BC3.Path+bnr.mobile_html5,'frameborder':0,'scrolling':'no'});}else if(bnr.mobile_img!=''){var $media=$(document.createElement('img')).attr('src',BC3.Path+bnr.mobile_img);}}else{return'';}if($media!==''){$media.css({'width':'100%','height':'100%'});if(bnr.mode=='desktop'){$bnr.css({'width':bnr.width+'px','height':bnr.height+'px'});}else if(bnr.mode=='mobile'){$bnr.css({'width':bnr.mobile_width+'px','height':bnr.mobile_height+'px'});}$bnr.append($media);}if(typeof(bnr.url)=='undefined')bnr.url='';if(bnr.url.length>1){var $link=$('<a class="link"></a>').attr('href','https://poltava.to/click.php?id='+bnr.id+(Template.IsMobile?'&m':''));$bnr.append($link);}return $bnr;},Dispose:function($bnr_place,bnrs){if(bnrs.length==0)return;var id=[];if(bnrs.length==1){var $bnr=BC3.Make(bnrs[0]);$bnr_place.append($bnr);id.push(bnrs[0].id);}else{var $table=$('<div class="display-table"></div>');var $row=$('<div class="display-row"></div>');var $empty_cell=$('<div class="display-cell"></div>');var $bnr_cell=$('<div class="display-cell width-0"></div>');for(var i=0;i<bnrs.length;i++){var $bnr=BC3.Make(bnrs[i]);$row.append($empty_cell.clone(),$bnr_cell.clone().append($bnr));id.push(bnrs[i].id);}$row.append($empty_cell);$bnr_place.append($table.append($row));}$bnr_place.attr('data-bnr',id.join(','));},OnScroll:function(){if(Template.IsMobile)return;if(location.toString()=='https://poltava.to/')return;var scroll_top=parseInt($(document).scrollTop());var window_height=parseInt($(window).height());var content_height=Template.ContentHeight;var visible_top=Math.max(0,scroll_top-BC3.SidebarOffset);var visible_bottom=visible_top+window_height;if(scroll_top<BC3.SidebarOffset)visible_bottom-=(BC3.SidebarOffset-scroll_top);if(visible_bottom>content_height)visible_bottom=content_height;var visible=[];for(var i=0;i<BC3.SidebarMatrix.length;i++){var matrix=BC3.SidebarMatrix[i];if(matrix.top<=visible_bottom&&matrix.bottom>=visible_top){if($.inArray(matrix.index,visible)==-1){var $bnr=BC3.DOM.SidebarBnrs.eq(matrix.index);$bnr.css({'position':'relative','left':0,'top':Math.round(matrix.top-matrix.base_offset)+'px'});visible.push(matrix.index);}}}}};$(BC3.Init);(function($){$.fn.curvedArrow=function(options){var settings=$.extend({p0x:50,p0y:50,p1x:70,p1y:10,p2x:100,p2y:100,size:30,lineWidth:10,strokeStyle:'rgb(245,238,49)'},options);var canvas=document.createElement('canvas');$(canvas).appendTo(this);var x_min_max=quadraticCurveMinMax(settings.p0x,settings.p1x,settings.p2x);var y_min_max=quadraticCurveMinMax(settings.p0y,settings.p1y,settings.p2y);var padding=settings.size-settings.lineWidth;var x_min=x_min_max[0]-padding;var x_max=x_min_max[1]+padding;var y_min=y_min_max[0]-padding;var y_max=y_min_max[1]+padding;var p0x=settings.p0x-x_min;var p0y=settings.p0y-y_min;var p1x=settings.p1x-x_min;var p1y=settings.p1y-y_min;var p2x=settings.p2x-x_min;var p2y=settings.p2y-y_min;canvas.style.position='absolute';canvas.style.top=y_min+'px';canvas.style.left=x_min+'px';canvas.width=x_max-x_min;canvas.height=y_max-y_min;var ctx=canvas.getContext('2d');ctx.strokeStyle=settings.strokeStyle;ctx.lineWidth=settings.lineWidth;ctx.lineJoin='round';ctx.lineCap='round';ctx.beginPath();ctx.moveTo(p0x,p0y);ctx.quadraticCurveTo(p1x,p1y,p2x,p2y);ctx.stroke();var angle=Math.atan2(p2y-p1y,p2x-p1x);ctx.translate(p2x,p2y);var a=1.3;ctx.rotate(angle+a);ctx.beginPath();ctx.moveTo(0,settings.size);ctx.lineTo(0,0);ctx.stroke();ctx.rotate(-2*a);ctx.lineTo(0,-settings.size);ctx.stroke();ctx.rotate(a-angle);ctx.translate(-p2x,-p2y);return $(canvas).addClass('curved_arrow');};function quadraticCurveMinMax(p0,p1,p2){var min=p0;var max=p2;var t_step=0.0001;for(var t=t_step;t<=1;t+=t_step){var f=(1-t)*(1-t)*p0+2*(1-t)*t*p1+(t*t*p2);if(f<min)min=f;if(f>max)max=f;}return[Math.round(min),Math.round(max)];}}(jQuery));var Comments={ContentType:'',ContentID:0,DOM:{},MaxLevel:4,UserID:0,UserName:'',DataComments:{},DataResponses:{},Status:{Loaded:false},AfterLoad:{CommentID:0,CommentForm:false,OpenUnderground:false},UpdateInterval:0,CurrentDate:false,Init:function(){Comments.DOM.Holder=$('#comments');if(Comments.DOM.Holder.length!=1)return;Comments.ContentType=Comments.DOM.Holder.attr('data-type');Comments.ContentID=parseInt(Comments.DOM.Holder.attr('data-id'),10);if(typeof(Comments.ContentType)=='undefined'||typeof(Comments.ContentID)=='undefined')return;Comments.GetCurrentDate();Comments.DOM.Num=Comments.DOM.Holder.find('.num-comments');var html=''+'<div class="comments-loading">Завантаження коментарів ...</div>'+'<div class="comments-stream">'+'   <div class="comments-list"></div>'+'   <div data-target="top" class="new-comment"></div>'+'   <div class="comments-add">'+'      <button data-target="top" class="add-comment">Додати свій коментар</button>'+'      <a href="#comments" data-target="top" class="add-comment" style="display:none;">Новий коментар</a>'+'   </div>'+'   <div class="comments-extend">'+'   <div class="clear-both"></div>'+'      <div class="comments-underground">'+'         <div class="clear-both"></div>'+'         <div class="comments-title"><a href="#underground">Видалені коментарі</a><span></span></div>'+'         <div class="comments-content">'+'            <div class="comments-list"></div>'+'         </div>'+'         <div class="clear-both"></div>'+'      </div>'+'   <div class="clear-both"></div>'+'   </div>'+'   <div class="comments-info"></div>'+'</div>';Comments.DOM.Holder.find('div.clear-both').last().before(html);Comments.DOM.Loading=Comments.DOM.Holder.find('.comments-loading');Comments.DOM.Stream=Comments.DOM.Holder.find('.comments-stream');Comments.DOM.TopList=Comments.DOM.Holder.find('.comments-list:first');Comments.DOM.Extend=Comments.DOM.Holder.find('.comments-extend');Comments.DOM.Underground=Comments.DOM.Extend.find('.comments-underground');Comments.DOM.UndergroundTitle=Comments.DOM.Underground.find('.comments-title');Comments.DOM.UndergroundContent=Comments.DOM.Underground.find('.comments-content');Comments.DOM.UndergroundList=Comments.DOM.Underground.find('.comments-list');Comments.DOM.AddButton=Comments.DOM.Stream.find('button.add-comment');Comments.DOM.AddLink=Comments.DOM.Stream.find('a.add-comment');Comments.DOM.Info=Comments.DOM.Holder.find('.comments-info');if(Template.UserID>0){Comments.UserID=Template.UserID;Comments.UserName=Template.UserName;}else{Comments.DOM.Info.append('<div>Для запобігання спаму коментувати можуть лише зареєстровані користувачі.<br /><a href="//poltava.to/login/" class="dialog-login">Авторизуйтеся</a> на сайті або пройдіть нескладну <a href="//poltava.to/registration/">реєстрацію</a>.</span></div>','<div class="fb-comments-auth-desktop"><div class="fb-login-button" data-width="300" data-size="large" data-button-type="login_with" data-auto-logout-link="false" data-use-continue-as="true" data-onlogin="Comments.FacebookAuthComplete();"></div></div>','<div class="fb-comments-auth-mobile"><a href="https://www.facebook.com/v5.0/dialog/oauth?client_id=142400765847681&amp;response_type=code&amp;redirect_uri=https%3A%2F%2Fpoltava.to%2Flogin%2F&state='+Comments.ContentType+'-'+Comments.ContentID+'" class="facebook-login-button"><span class="icon"></span> <span class="text">Авторизуватися через Facebook</span></a></div>').show();Comments.DOM.Info.find('a.dialog-login').bind('click',Comments.ShowLoginDialog);if(FacebookTools.Ready)FB.XFBML.parse(document.getElementById('fb-comments-auth'));}Comments.DOM.Welcome=Comments.DOM.Holder.find('.comments-welcome');Comments.DOM.Welcome.find('a:first').add(Comments.DOM.Num).bind('click',Comments.Open);Comments.DOM.Welcome.find('a:last').bind('click',Comments.OpenAndComment);Comments.DOM.AddButton.bind('click',Comments.AddComment);Comments.DOM.AddLink.bind('click',Comments.AddComment);Comments.DOM.UndergroundTitle.bind('click',Comments.OpenUnderground);var url=location.toString();if(/#comments$/.test(url)){Comments.Open();}else if(/#comment-(\d+)$/.test(url)){Comments.AfterLoad.CommentID=parseInt(RegExp.$1,10);Comments.Open();}else if(/#underground$/.test(url)){Comments.AfterLoad.OpenUnderground=true;Comments.Open();}$(window).bind('resize',Comments.ClearArrow);},GetCurrentDate:function(){var reDate=/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})/;if(reDate.test(Template.PageDT)){_day=parseInt(RegExp.$3,10);_month=parseInt(RegExp.$2,10);_year=parseInt(RegExp.$1,10);_hour=parseInt(RegExp.$4,10);_min=parseInt(RegExp.$5,10);Comments.CurrentDate=new Date(_year,_month-1,_day,_hour,_min,0);}else Comments.CurrentDate=new Date();},ShowLoginDialog:function(){if(typeof(DesktopLogin)!='undefined')DesktopLogin.OpenDialog();return false;},Open:function(){Comments.DOM.Stream.hide();Comments.DOM.Loading.show();clearInterval(Comments.UpdateInterval);Comments.Load(Comments.LoadComplete,Comments.LoadError);return false;},OpenAndComment:function(){if(Comments.Status.Loaded){var target='top';Comments.CommentForm(target);}else{Comments.AfterLoad.CommentForm=true;Comments.Open();}return false;},Load:function(success_fn,error_fn){var url='/comments/'+Comments.ContentType+'/';url+=Math.ceil(Comments.ContentID/100);url+='/'+Comments.ContentID+'.txt';$.ajax({url:url,type:'get',cache:false,dataType:'text',success:success_fn,error:typeof(error_fn)=='function'?error_fn:function(){}});return false;},LoadComplete:function(response){Comments.ParseData(response);Comments.DOM.Loading.hide();Comments.DOM.Stream.show();Comments.Build();Comments.Status.Loaded=true;Comments.ScrollAfterLoad();Comments.RestartUpdate();},LoadError:function(){Comments.LoadComplete('');},ParseData:function(txt){if(txt=='')return;var tmp='['+txt.substring(0,txt.length-1)+']';var responses={};var comments={};var json={};try{json=$.parseJSON(tmp);}catch(e){}var reR=/^([a-z]+)\|(\d+)\|(\d+)/;for(var i in json){var obj=json[i];if(typeof(obj.r)!='undefined'&&reR.test(obj.r)){var comment_id=parseInt(RegExp.$2,10);var r={type:RegExp.$1,user_id:parseInt(RegExp.$3,10),};if(typeof(responses[comment_id])=='undefined')responses[comment_id]=[];responses[comment_id].push(r);if(r.user_id==Comments.UserID){switch(r.type){case'badwords':if(typeof(comments[comment_id])!='undefined')comments[comment_id].censored=1;break;case'antiukraine':case'insult':case'flood':case'stupid':if(typeof(comments[comment_id])!='undefined')comments[comment_id].deleted=1;break;case'restore':if(typeof(comments[comment_id])!='undefined')comments[comment_id].deleted=0;break;}}}if(typeof(obj.id)!='undefined')comments[obj.id]=obj;}Comments.DataComments=comments;Comments.DataResponses=responses;},Build:function(data){var data=Comments.DataComments;Comments.DOM.TopList.empty();Comments.DOM.UndergroundList.empty();var max_comment_id=0;for(var i in data){var comment=data[i];if(comment.id>max_comment_id)max_comment_id=comment.id;Comments.AppendComment(comment);}Comments.DOM.TopList.children('.comment').each(Comments.ProcessHiddenComments);Comments.UpdateNum();Comments.LastCookie(max_comment_id);Template.OnResize();},ProcessHiddenComments:function(){var $comment=$(this);var comment_id=$comment.attr('data-id');var $children_comments=Comments.DOM.TopList.find('.comment[data-reply='+comment_id+']');if($children_comments.length==0)return;var $hidden_comments=$children_comments.filter('[data-hidden=1]');if($hidden_comments.length>0){var hidden_indexes='';if(typeof(localStorage)=='object')hidden_indexes=localStorage.getItem('hidden_comments');if(hidden_indexes===null)hidden_indexes='';var hide=Comments.GetAllComments($hidden_comments);var is_new=false;var is_viewed=false;var authors={};var max_level=1;for(var i in hide){var c_id=hide[i];if(is_viewed==false){if(hidden_indexes.indexOf(c_id)!=-1)is_viewed=true;}var $c=Comments.DOM.TopList.find('#comment-'+c_id);if(is_new===false&&$c.children('.comment-new').length>0)is_new=true;var author=$c.children('.comment-block').find('.comment-author').text();var level=$c.attr('data-level');if(typeof(authors[author])=='undefined')authors[author]=[];authors[author].push(level);if(level>max_level)max_level=level;$c.hide();}var rating=[];for(var i in authors){var sum=0;for(var j in authors[i])sum+=max_level-authors[i][j]+1;rating.push({name:i,value:sum});}rating.sort(function(a,b){return b.value-a.value;});var str='';for(var i in rating)str+=rating[i].name+' -> '+rating[i].value+"\n";authors=[];for(var i=0;i<Math.min(rating.length,3);i++)authors.push(rating[i].name);var authors_list='';if(rating.length>3)authors_list=authors.join(', ')+' та ін.';else if(authors.length==3)authors_list=authors[0]+', '+authors[1]+' та '+authors[2];else if(authors.length==2)authors_list=authors[0]+' та '+authors[1];else authors_list=authors[0];var msg='Видалені коментарі: <a href="#comments">'+hide.length+'&nbsp;шт.</a> від '+authors_list;var new_hider=(is_new&&is_viewed)?' comment-hider-new':'';var $block=$('<div class="comment-hider'+new_hider+'" data-id="'+hide.join(',')+'"><div>'+msg+'</div></div>');$children_comments.eq(0).before($block);$block.find('a').bind('click',Comments.ShowHiddenComments);}$children_comments.not('[data-hidden=1]').each(Comments.ProcessHiddenComments);},ShowHiddenComments:function(e){var $a=$(this);var $hider=$a.parents('.comment-hider');if($hider.length!=1)return false;Comments.ClearArrow();if(Comments.UserName==''){Comments.MessageHiderAuth($hider);return false;}if(Comments.Test4Underground()){var ids=$hider.attr('data-id').split(',');$hider.remove();for(var i in ids)Comments.DOM.TopList.find('#comment-'+ids[i]).fadeIn();Comments.UpdateHiddenIDs(ids);}else{Comments.MessageHider($hider);return false;}return false;},Test4Underground:function(){if(typeof(localStorage)=='object'){var test=localStorage.getItem('confirm_underground');if(test==1)return true;}return false;},AcceptUnderground:function(){if(typeof(localStorage)=='object')localStorage.setItem('confirm_underground',1);},UpdateHiddenIDs:function(ids){if(typeof(localStorage)!='object')return;var d=Math.round(new Date().getTime()/86400000);var update={};for(var i in ids)update[ids[i]]=d;var str=localStorage.getItem('hidden_comments');if(str!==null){var arr=str.split(';');for(var i in arr){var c=arr[i].split('/');if(c[1]<d-5)continue;if(typeof(update[c[0]])=='undefined')update[c[0]]=c[1];}}var arr=[];for(var i in update)arr.push(i+'/'+update[i]);localStorage.setItem('hidden_comments',arr.join(';'));},GetAllComments:function($comments){var data=[];var n=$comments.length;for(var i=0;i<n;i++){var $comment=$comments.eq(i);var comment_id=$comment.attr('data-id');data.push(comment_id);var $child=Comments.DOM.TopList.find('.comment[data-reply='+comment_id+']');if($child.length>0){var tmp=Comments.GetAllComments($child);for(var j in tmp)data.push(tmp[j]);}}return data;},LastCookie:function(set_value){var name='c'+Comments.ContentType+Comments.ContentID;if(typeof(set_value)!='undefined'){var reLoc=/^https?:\/\/(poltava.to|blog.poltava.to)(.*\/)([^\/]*)$/;var loc=location.toString();if(reLoc.test(loc)){var domain=RegExp.$1;var path=RegExp.$2;$.cookie(name,set_value,{expires:5,path:path,domain:domain});}}else{var tmp=$.cookie(name);return tmp?parseInt(tmp):0;}},ScrollAfterLoad:function(){if(Comments.AfterLoad.CommentID>0){var $comment=$('#comment-'+Comments.AfterLoad.CommentID);if($comment.length==1){if($comment.parents('.comments-underground').length!=0){return;}Comments.ScrollToComment();}location.href='#comments';}else{if(Comments.AfterLoad.OpenUnderground==true){Comments.OpenUnderground();location.href='#underground';}else{if(Comments.AfterLoad.CommentForm==true){var target='top';Comments.CommentForm(target);Comments.AfterLoad.CommentForm=false;}else{var top=Comments.DOM.Holder.offset().top-7;$.scrollTo({top:top+'px',left:0},1000);}location.href='#comments';}}},ScrollToComment:function(comment_id){if(typeof(comment_id)=='undefined')comment_id=Comments.AfterLoad.CommentID;if(comment_id>0){var $comment=$('#comment-'+comment_id);if($comment.length==1){var top=0;if($comment.is(':visible')){top=$comment.offset().top-10;}else{$hiders=Comments.DOM.TopList.find('.comment-hider');for(var i=0;i<$hiders.length;i++){var ids=$hiders.eq(i).attr('data-id');if(ids.indexOf(comment_id)!=-1){top=$hiders.eq(i).offset().top-10;break;}}}if(top>0)$.scrollTo({top:top+'px',left:0},1000);}Comments.AfterLoad.CommentID=0;}},OpenUnderground:function(){if(Comments.UserName==''){Comments.MessageUndergroundAuth();return false;}if(Comments.Test4Underground()){Comments.DOM.UndergroundContent.show();var top=Comments.DOM.Underground.offset().top-10;$.scrollTo({top:top+'px',left:0},1000);location.href='#underground';Template.OnResize();}else{Comments.MessageUnderground();}return false;},AppendComment:function(comment){var $comment=Comments.Single(comment);if(comment.reply_id>0){$parent=$('#comment-'+comment.reply_id);if($parent.length!=1)return;var parent_level=parseInt($parent.attr('data-level'),10);$comment.attr('data-level',parent_level+1);var $target=$parent;if(parent_level>Comments.MaxLevel)$target=$parent.parents('.comment[data-level='+Comments.MaxLevel+']');if($target.length==1)$target.children('.comment-child').append($comment);}else{$comment.attr('data-level',1);var target='top';if(typeof(comment.deleted)!='undefined'&&comment.deleted==1)target='underground';switch(target){case'top':Comments.DOM.TopList.append($comment);break;case'underground':Comments.DOM.UndergroundList.append($comment);Comments.DOM.Extend.show();break;}}},CommentForm:function(target){Comments.ClearArrow();var $target=null;var recipient='';var reply_id=0;switch(target){case'top':case'underground':$target=Comments.DOM.Holder.find('div.new-comment[data-target='+target+']');if(Comments.UserName==''){Comments.MessageAddComment($target);return false;}Comments.DOM.AddButton.show().filter('[data-target='+target+']').hide();Comments.DOM.AddLink.hide();break;default:var $comment=Comments.DOM.Holder.find('#comment-'+target);var recipient=$.trim($comment.find('.comment-author:first').text());if($comment.length==1){var comment_id=$comment.attr('data-id');var comment_level=parseInt($comment.attr('data-level'),10);if(comment_level<=Comments.MaxLevel)$target=$comment.children('.comment-child');else $target=$comment.parents('.comment[data-level='+Comments.MaxLevel+']').children('.comment-child');if($comment.parents('.comments-underground').length!=0){Comments.DOM.AddButton.show().filter('[data-target=underground]').hide();Comments.DOM.AddLink.hide().filter('[data-target=underground]').show();}else{Comments.DOM.AddButton.show().filter('[data-target=top]').hide();Comments.DOM.AddLink.hide().filter('[data-target=top]').show();}reply_id=comment_id;}break;}if($target==null||$target.length!=1)return false;var $comment_form=Comments.ReplyForm(target,recipient);Comments.DOM.Holder.find('.comment-form').remove();$target.append($comment_form);var $textarea=$comment_form.find('textarea');var text=$textarea.val();$textarea.focus().val('').val(text);if(reply_id>0)Comments.DrawArrow('form',comment_id);var y=$comment_form.offset().top;var H=$(window).height();var h=$comment_form.height();var top=Math.round(y-(H-h)/2);$.scrollTo({top:top+'px',left:0},500);},Single:function(comment){var br_text=Comments.Tools.HTML_Links(Comments.Tools.BR(comment.text));br_text+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';var comment_text='';if(typeof(comment.censored)!='undefined'&&comment.censored==1){comment_text='<div class="comment-censored-control"><span>Коментар містить знижений експресивний узус</span> | <a href="">Показати коментар</a></div>';comment_text+='<div class="comment-censored">'+br_text+'</div>';}else{comment_text=br_text;}var dt=typeof(comment.dt)!='undefined'?comment.dt:comment.ts;var normal_info='<span class="full-date">'+Comments.Tools.ToDate(dt)+'</span>'+'<span class="short-date">'+Comments.Tools.ToShortDate(dt)+'</span>';if(typeof(comment.geo)!='undefined'&&$.trim(comment.geo)!=''){var geo=comment.geo.replace(/^Україна,\s/,'');if(geo.indexOf('Росія')===0)geo='<strong style="color:red">'+geo+'</strong>';normal_info+='&nbsp;-&nbsp;'+geo;}var likes=Comments.GetLikes(comment.id);var likes_str=likes.count>0?likes.count:'';var abuse_html='';if(comment.user_id!=Comments.UserID){if(typeof(comment.deleted)!='undefined'&&comment.deleted==1&&Comments.UserName!='')abuse_html=' | <a href="" class="comment-restore">Апеляція</a>';else abuse_html=' | <a href="" class="comment-abuse">Скарга</a>';}var comment_new='';var last_id=Comments.LastCookie();if(last_id>0&&comment.id>last_id&&comment.user_id!=Comments.UserID)comment_new=' comment-new';var data_hidden=(typeof(comment.deleted)!='undefined'&&comment.deleted==1)?1:0;var html=''+'<div id="comment-'+comment.id+'" data-id="'+comment.id+'" data-reply="'+comment.reply_id+'" data-hidden="'+data_hidden+'" class="comment comment-single">'+'   <div class="comment-block'+comment_new+'">'+'   <div class="comment-body relative">'+'      <div class="comment-text">'+comment_text+'      </div>'+'      <span class="comment-likes user-select-none'+(likes.is_liked?' comment-liked':'')+'">'+'          <span class="display-row">'+'              <span class="display-cell"><span class="icon"></span></span>'+'              <span class="display-cell"><span data-n="'+likes.count+'" class="counter relative">'+likes_str+'</span></span>'+'          </span>'+'      </span>'+'   </div>'+'   <div class="comment-footer">'+'      <span class="comment-author">'+(typeof(CommentAdmin)!='undefined'?CommentAdmin.ExtendNickname(comment.user_id,comment.nickname):comment.nickname)+'</span>'+'      <span class="comment-info">'+normal_info+'</span>'+'      <span class="comment-fn">'+'         <a href="" class="comment-reply">Відповісти</a>'+(typeof(CommentAdmin)!='undefined'?CommentAdmin.ExtendFn(comment):abuse_html)+'      </span>'+'      <div class="clear-both"></div>'+'   </div>'+'   </div>'+'   <div class="comment-child"></div>'+'</div>';$comment=$(html);if(likes.count>0){$comment.find('.counter').css('display','block');}$comment.find('.comment-reply').on('click',Comments.Reply);$comment.find('.comment-likes').on('click',Comments.Like);$comment.find('.comment-abuse').on('click',Comments.Abuse);$comment.find('.comment-restore').on('click',Comments.Restore);$comment.find('.comment-censored-control > a').on('click',Comments.NoCensore);if(comment.reply_id>0){$comment.find('.comment-block').on('click',Comments.ShowReplyArrow).on('dblclick',Comments.ShowReplyArrow);}if(typeof(CommentAdmin)!='undefined')CommentAdmin.BindEvents($comment);return $comment;},NoCensore:function(){var $text=$(this).parents('.comment-text');$text.find('.comment-censored-control').remove();$text.find('.comment-censored').show();return false;},ShowReplyArrow:function(e){var $comment_block=$(this);var $comment=$comment_block.parent();var comment_id=$comment.attr('data-id');var reply_id=$comment.attr('data-reply');Comments.ClearArrow();if(reply_id==0)return false;Comments.DrawArrow(comment_id,reply_id);if(e.type=='dblclick')Comments.ScrollToComment(reply_id);},DrawArrow:function(id1,id2){var $c1=Comments.DOM.Holder.find('#comment-'+id1);var $c2=Comments.DOM.Holder.find('#comment-'+id2).children('.comment-block').find('.comment-footer');if($c1.length!=1||$c2.length!=1)return;var x0=$c1.position().left-2;var y0=$c1.position().top+10;var x2=$c2.position().left-2;var y2=$c2.position().top+10;var x1=x2<x0?x2-60:(y0-y2>500?40:x2-30);var y1=Math.round((y0+y2)/2);try{Comments.DOM.Holder.curvedArrow({p0x:x0,p0y:y0,p1x:x1,p1y:y1,p2x:x2,p2y:y2,size:12,lineWidth:1,strokeStyle:'#999'});}catch(e){}},ClearArrow:function(){Comments.DOM.Holder.find('canvas').remove();},Like:function(){var $likes=$(this);var $comment=$likes.parents('.comment:first');var $counter=$likes.find('.counter');var comment_id=parseInt($comment.attr('data-id'));if(Comments.UserName==''){Comments.MessageLike($comment);return false;}Comments.RestartUpdate();if(typeof(Comments.DataComments[comment_id])=='undefined')return false;var comment=Comments.DataComments[comment_id];if(comment.user_id==Comments.UserID)return false;var is_liked=Comments.IsLiked(comment_id);var n=parseInt($counter.attr('data-n'),10);if(isNaN(n))n=0;if(is_liked){Comments.SetLikes(comment_id,n-1,false);Comments.SendResponse(comment_id,'unlike');}else{Comments.SetLikes(comment_id,n+1,true);Comments.SendResponse(comment_id,'like');}return false;},AddComment:function(){var $button=$(this);var target=$button.attr('data-target');Comments.CommentForm(target);return false;},Reply:function(){var $a=$(this);var $comment=$a.parents('.comment:first');var comment_id=$comment.attr('data-id');if(Comments.UserName==''){Comments.MessageReply($comment);}else{Comments.CommentForm(comment_id);}return false;},ReplyForm:function(target,recipient){var text=recipient?recipient+','+String.fromCharCode(32):'';var td_email='';if(Comments.DOM.Holder.attr('data-email')==1){var checked=Comments.DOM.Holder.attr('data-noreply')==0?'checked="checked"':'';td_email='<td><input id="reply_email" type="checkbox" name="reply_email" '+checked+' /></td>'+'<td style="padding: 0 10px 0 3px;"><label for="reply_email">Отримувати відповіді на e-mail</label></td>';}var html=''+'<div id="comment-form" class="comment comment-form">'+'   <div class="comment-block">'+'   <div class="comment-body relative">'+'      <div class="comment-text">'+'         <textarea rows="4">'+text+'</textarea>'+'      </div>'+'   </div>'+'   <div class="comment-footer">'+'      <span class="comment-author">'+Comments.UserName+'</span>'+'      <span class="comment-counter"></span>'+'      <span class="comment-fn">'+'         <table cellspacing="0" cellpadding="0" border="0">'+'            <tr>'+td_email+'               <td><input type="button" data-target="'+target+'" value="Відправити" /></td>'+'            </tr>'+'         </table>'+'      </span>'+'      <div class="clear-both"></div>'+'   </div>'+'   </div>'+'</div>';var $form=$(html);var $textarea=$form.find('textarea');$textarea.bind('keyup',Comments.UpdateTextCounter);Comments.DOM.SubmitButton=$form.find('input[type=button]');Comments.DOM.SubmitButton.bind('click',Comments.Submit);return $form;},UpdateTextCounter:function(){var $textarea=$(this);var $comment=$textarea.parents('.comment-form');var $counter=$comment.find('.comment-counter');var text=$textarea.val();var len=text.length;var n=Math.max(1000-len,0);if(len>1000){text=text.substring(0,1000);$textarea.focus().val('').val(text);}$counter.text(n);},SetLikes:function(comment_id,n,is_liked){if(n<0)n=0;var $comment=$('#comment-'+comment_id);if($comment.length!=1)return;var $likes=$comment.find('.comment-likes:first');var $icon=$likes.find('.icon');var $counter=$likes.find('.counter');var current_n=parseInt($counter.attr('data-n'),10);if(isNaN(n))n=0;if(n==current_n)return;$counter.attr('data-n',n);if(is_liked)$likes.addClass('comment-liked');else $likes.removeClass('comment-liked');if(n==0){$counter.fadeOut();return;}var $tmp1=$('<span style="opacity: 0;"></span>').text(n);var $tmp2=$('<span style="opacity: 1; position: absolute; left: 0px; z-index: 2;"></span>');if(n>current_n){if(current_n==0)current_n='';$tmp2.html(n+'<br />'+current_n).css('top','-1.3em');$counter.empty().append($tmp1,$tmp2).show();$tmp2.animate({'top':'0.1em'},250).animate({'top':0},30);}else{$tmp2.html(current_n+'<br />'+n).css('top','-0.1em');$counter.empty().append($tmp1,$tmp2).show();$tmp2.animate({'top':'-1.4em'},250).animate({'top':'-1.3em'},30);}},Restore:function(){if(Comments.UserName=='')return false;var $a=$(this);var $comment_block=$a.parents('.comment-block');var $comment=$comment_block.clone();$comment.find('.comment-fn').remove();var comment_id=$comment_block.parent().attr('data-id');$comment.attr('data-id',comment_id);var $text=$comment.find('.comment-text');var $censored=$text.find('.comment-censored');var text=$censored.length==1?$censored.text():$text.text();if(text.length>200)text=text.substring(0,200)+' ...';$text.html(text);var $holder=$('<div class="comment-abusing"></div>');$holder.append($comment);var $div=$('<div></div>').append($holder);;var html='<div style="padding: 4px; text-align: center;">';html+='<div class="message success" style="display: none;"></div>';html+='<p style="margin: 6px;">Якщо ви впевнені, що цей коментар не порушує <a href="//poltava.to/registration/rules/">правила&nbsp;сайту</a>, і його було видалено помилково, то ви можете надіслати апеляцію модератору.</p>';html+='</div>';Dialog.Open({title:'Апеляція щодо видаленого коментаря',raw_content:$div.html(),content:html,width:'400px',action:'',method:'post',onsubmit:Comments.SendAbuse,buttons:[{type:'submit',value:'Надіслати апеляцію',extend_class:'',fn:Comments.SendAppeal},{type:'submit',value:'Не варто',extend_class:'',fn:Dialog.Close}]});return false;},Abuse:function(){var $a=$(this);if(Comments.UserName==''){var $comment=$a.parents('.comment:first');Comments.MessageAbuse($comment);return false;}var $comment_block=$a.parents('.comment-block');var $comment=$comment_block.clone();$comment.find('.comment-fn').remove();if(Template.IsMobile)$comment.find('.comment-info').remove();var comment_id=$comment_block.parent().attr('data-id');$comment.attr('data-id',comment_id);var $text=$comment.find('.comment-text');var $censored=$text.find('.comment-censored');var text=$censored.length==1?$censored.text():$text.text();if(text.length>200)text=text.substring(0,200)+' ...';$text.html(text);var $holder=$('<div class="comment-abusing"></div>');$holder.append($comment);var $div=$('<div></div>').append($holder);;var abuses={'badwords':'Нецензурна лексика','antiukraine':'Антиукраїнська риторика','insult':'Хамство','flood':'Не по темі','stupid':'Просто безглуздий текст'};var html='<div class="dialog-content">';html+='<div class="message success" style="display: none;"></div>';html+='<table cellspacing="6" cellpadding="0" border="0" style="margin: 0 auto 0 auto;">';for(var key in abuses)html+='<tr><td><input id="abuse-'+key+'" type="checkbox" value="'+key+'" style="margin: 0;" /></td><td><label for="abuse-'+key+'">'+abuses[key]+'</label></td></tr>';html+='</table>';html+='</div>';Dialog.Open({title:'Скарга на коментар, який порушує <a href="//poltava.to/registration/rules/">правила сайту</a>',raw_content:$div.html(),content:html,width:'400px',action:'',method:'post',onsubmit:Comments.SendAbuse,buttons:[{type:'submit',value:'Надіслати скаргу',extend_class:'',fn:Comments.SendAbuse},{type:'submit',value:'Не варто',extend_class:'',fn:Dialog.Close}]});return false;},SendAbuse:function(){Comments.ClearArrow();var $comment_block=Dialog.DOM.Holder.find('.comment-block');if($comment_block.length!=1)return false;var comment_id=$comment_block.attr('data-id');var $message=Dialog.DOM.Holder.find('.message').hide();var abuses=[];Dialog.DOM.Holder.find('input[type=checkbox]:checked').each(function(){abuses.push($(this).val());});if(abuses.length==0){$message.removeClass('success').addClass('error').text('Вкажіть причину скарги на коментар').fadeIn();}else{Comments.SendResponse(comment_id,abuses.join(','));Comments.ApplyAbuse(comment_id,abuses);$message.removeClass('error').addClass('success').text('Вашу скаргу надіслано модератору').fadeIn();var $buttons=Dialog.DOM.Holder.find('.dialog-buttons');$buttons.find('input:first').remove();$buttons.find('input').val('Закрити');}if(typeof(Dialog)!='undefined')Dialog.LocateDialog();return false;},SendAppeal:function(){Comments.ClearArrow();var $comment_block=Dialog.DOM.Holder.find('.comment-block');if($comment_block.length!=1)return false;var comment_id=$comment_block.attr('data-id');var $message=Dialog.DOM.Holder.find('.message').hide();Comments.SendResponse(comment_id,'restore');$message.removeClass('error').addClass('success').text('Вашу апеляцію надіслано модератору').fadeIn();var $buttons=Dialog.DOM.Holder.find('.dialog-buttons');$buttons.find('input:first').remove();$buttons.find('input').val('Закрити');Comments.DisableRestoreLink(comment_id);return false;},DisableRestoreLink:function(comment_id){$comment=Comments.DOM.Holder.find('.comment[data-id='+comment_id+']');$comment.fadeOut();},IsLiked:function(comment_id){var $comment=$('#comment-'+comment_id);var $likes=$comment.children('.comment-block').find('.comment-likes');if($likes.hasClass('comment-liked'))return true;return false;},GetLikes:function(comment_id){var likes={count:0,is_liked:false};if(typeof(Comments.DataResponses[comment_id])!='undefined'){var tmp={};var data=Comments.DataResponses[comment_id];for(var i in data){var r=data[i];if(r.type=='like'||r.type=='unlike')tmp[r.user_id]=r.type;}for(var i in tmp){if(tmp[i]=='like')likes.count++;}if(Comments.UserID>0&&typeof(tmp[Comments.UserID])!='undefined'&&tmp[Comments.UserID]=='like')likes.is_liked=true;}return likes;},SendResponse:function(comment_id,response){$.ajax({url:'/ajax2/comment-response.php',type:'post',dataType:'text',data:{comment_id:comment_id,response:response},success:Comments.ResponseComlete});},ResponseComlete:function(response){console.log(response);},Censore:function(comment_id){var $comment=Comments.DOM.Holder.find('.comment[data-id='+comment_id+']');if($comment.length!=1)return false;var $block=$comment.children('.comment-block');var $content=$block.find('.comment-text');var control='<div class="comment-censored-control"><span>Ми отримали вашу скаргу цей коментар</span> | <a href="">Показати коментар</a></div>';var $censored=$('<div class="comment-censored"></div>').append($content.html());$content.empty().append(control,$censored);$content.find('.comment-censored-control > a').bind('click',Comments.NoCensore);return false;},ApplyAbuse:function(comment_id,abuses){if(abuses.length>1||abuses[0]!='badwords')Comments.DOM.Holder.find('.comment[data-id='+comment_id+']').fadeOut(function(){Template.UpdateContentHeight();Template.OnResize();});else Comments.Censore(comment_id);},UpdateNum:function(){var top_count=Comments.DOM.TopList.find('.comment-single').length;var underground_count=Comments.DOM.UndergroundList.find('.comment-single').length;var sum=top_count+underground_count;Comments.DOM.Num.text(sum);if(underground_count>0){Comments.DOM.UndergroundTitle.find('span').html(' ('+underground_count+'&nbsp;шт.)');Comments.DOM.Underground.show();}else{Comments.DOM.UndergroundTitle.find('span').empty();Comments.DOM.Underground.hide();}},Submit:function(){var $button=$(this);var $form=$button.parents('.comment-form');var $textarea=$form.find('textarea');var text=$.trim($textarea.val().replace(/([\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2694-\u2697]|\uD83E[\uDD10-\uDD5D])/g,''));var just_chars=' ';var ABC='АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯҐЄІЇABCDEFGHIJKLMNOPQRSTUVWXYZ';var abc='абвгдеёжзийклмнопрстуфхцчшщъыьэюяґєіїabcdefghijklmnopqrstuvwxyz';var caps=0;for(var i=0;i<text.length;i++){var char=text.charAt(i);if(ABC.indexOf(char)!=-1){caps++;just_chars+=char;}else{if(abc.indexOf(char)!=-1)just_chars+=char;else just_chars+=' ';}}just_chars+=' ';if(caps/text.length>0.5){var text2='';for(var i=0;i<text.length;i++){var c=text.charAt(i);var pos=ABC.indexOf(c);if(pos==-1)text2+=c;else{if(i==0||(i>=3&&(text.charAt(i-2)=='.'&&text.charAt(i-1)==' ')))text2+=c;else text2+=abc.charAt(pos);}}if(Template.IsMobile){$textarea.val(text2);Comments.MessageSubmit($form,"На нашому сайті заборонено писати коментарі КАПСом. Великі літери були автоматично замінені малими.");return false;}else{if(confirm("На нашому сайті заборонено писати коментарі КАПСом.\nВеликі літери будуть автоматично замінені малими."))$textarea.val(text2);return false;}}var reSpam=/(kolo|vpoltave|rusvesna|salta-news|blog-donbassa|rosukrinform|cyber-berkut|bastion|peremogi|poltava.today|poltava365|tribuna|visti.pl)/;if(reSpam.test(text)){Comments.MessageSubmit($form,'Ваш коментар заблоковано спам-фільтром');return false;}var eq_chars={'a':'а','c':'с','e':'е','i':'і','o':'о','x':'х','y':'у','3':'з'};var cyr_text=text;for(i in eq_chars){var reChar=new RegExp(i,'gi');var cyr_text=cyr_text.replace(reChar,eq_chars[i]);}var mat='рагули,рагуль,ипанашк,хуй,ахуел,нахуя,дохуя,хуев,хует,похуизм,пизд,пезд,заебал,писька,письку,письки,дебил,дибил,гнида,придурок,срака,майдаун,муйдан,прдун,ригианал,какел,свиноеб,хохлят,теляч,миздобул,мыздобул,майданут,долбоеб,блядь,херои,свидом,гавно,пидарас,пидорас,хуесос,педораз,ылона,какл,какел'.split(',');for(i in mat){var reMat=new RegExp(mat[i].split('').join('\\s*'),'i');var mat_result=cyr_text.match(reMat);if(mat_result){var mat1=mat_result[0];var pos=cyr_text.indexOf(mat1);var len=mat1.length;var text_after=cyr_text.substring(pos+len);var mat0=mat1;var space_result=text_after.match(/([^\s]+)\s/);if(space_result)mat0+=' '+space_result[0];else mat0+=text_after;Comments.MessageSubmit($form,'Будь ласка,'+String.fromCharCode(32)+'не використовуйте нецензурну лексику:'+"\n\n👉 "+mat0);return false;}}mat='блять'.split(',');for(i in mat){var mat_word=' '+mat[i]+' ';if(just_chars.indexOf(mat_word)!=-1){Comments.MessageSubmit($form,'Будь ласка,'+String.fromCharCode(32)+'не використовуйте нецензурну лексику:'+"\n\n👉 "+mat_word);return false;}}text=$.trim(text);if(text==''){Comments.MessageSubmit($form,'Мабуть, вам бракує слів, щоб прокоментувати це? Так буває...');return false;}var data={text:text,reply_email:$form.find('input[name=reply_email]:checked').length,target:$button.attr('data-target'),content_type:Comments.ContentType,content_id:Comments.ContentID,geo:Comments.Geo};Comments.SubmitStatus(false);$.ajax({url:'/ajax2/comment.php',type:'post',dataType:'text',data:data,success:Comments.SubmitComplete,error:Comments.SubmitError});},SubmitStatus:function(status){if(status)Comments.DOM.SubmitButton.val('Відправити').removeAttr('disabled');else Comments.DOM.SubmitButton.val('Відправка ...').attr('disabled','disabled');},SubmitComplete:function(response){var json=null;try{json=$.parseJSON(response);}catch(e){alert(response);Comments.SubmitStatus(true);return;}Comments.DOM.Holder.find('.comment-form').remove();Comments.AppendComment(json);Comments.UpdateNum();Comments.DOM.AddButton.show();},SubmitError:function(){alert('Відсутній зв’язок з сервером');Comments.SubmitStatus(true);},RestartUpdate:function(){clearInterval(Comments.UpdateInterval);Comments.UpdateInterval=setInterval(Comments.Update,20000);},Update:function(){Comments.Load(Comments.ProcessUpdateData)},ProcessUpdateData:function(response){Comments.ParseData(response);Comments.DOM.Holder.find('.comment').each(function(){var $comment=$(this);var comment_id=$comment.attr('data-id');var likes=Comments.GetLikes(comment_id);Comments.SetLikes(comment_id,likes.count,likes.is_liked);});},RemoveMessages:function(){Comments.DOM.Holder.find('.message').remove();},DesktopAuthMessage:function(text){var html='<div style="margin: 20px 30px 10px 30px; text-align: center;">'+text+'</div>';html+='<div style="font-size: 11px; margin-bottom: 20px; text-align: center;">'+Comments.MessageRegRow();Dialog.Open({title:'Полтавщина',content:html,width:'360px',action:'',method:'post',onready:function(){Dialog.DOM.Holder.find('a.dialog-login').bind('click',DesktopLogin.OpenDialog);},buttons:[{type:'submit',value:'Авторизуватися',extend_class:'',fn:DesktopLogin.OpenDialog},{type:'submit',value:'Іншим разом',extend_class:'',fn:Dialog.Close}]});},MobileAuthMessage:function($comment,text){var $target=$comment.children('.comment-child');var html='<div>'+text+'</div>'+Comments.MessageRegRow();Comments.MobileMessage($target,html);},MessageRegRow:function(){return'<div><a href="//poltava.to/login/" class="dialog-login">Авторизація</a> | <a href="//poltava.to/registration/">Реєстрація</a></div>';},MobileMessage:function($target,html,mode,fn_process){if(typeof(mode)=='undefined')mode='before';Comments.RemoveMessages();var $message=$('<div class="message error"></div>');$message.append(html);$message.find('.dialog-login').bind('click',function(){if(typeof(DesktopLogin)!='undefined')DesktopLogin.OpenDialog();return false;});switch(mode){case'before':$target.before($message);break;case'after':$target.after($message);break;case'append':$target.append($message);break;default:return;}var top=$message.offset().top;var h=$message.height();var H=$(window).height();var offset=Math.round(top-(H-h)/2);$.scrollTo({top:offset+'px',left:0},300);if(typeof(fn_process)=='function')fn_process($message);},MessageReply:function($comment){if(Template.IsMobile)Comments.MobileAuthMessage($comment,'Коментувати можуть лише зареєстровані користувачі.');else Comments.DesktopAuthMessage('Коментувати можуть лише зареєстровані користувачі.');},MessageAbuse:function($comment){if(Template.IsMobile)Comments.MobileAuthMessage($comment,'Надсилати скарги на коментарі можуть лише зареєстровані користувачі.');else Comments.DesktopAuthMessage('Надсилати скарги на коментарі можуть лише зареєстровані користувачі.');},MessageLike:function($comment){if(Template.IsMobile)Comments.MobileAuthMessage($comment,'Оцінювати коментарі можуть лише зареєстровані користувачі.');else Comments.DesktopAuthMessage('Оцінювати коментарі можуть лише зареєстровані користувачі.');},MessageAddComment:function($target){if(Template.IsMobile)Comments.MobileMessage($target,'<div>Коментувати можуть лише зареєстровані користувачі.</div>'+Comments.MessageRegRow(),'append');else Comments.DesktopAuthMessage('Коментувати можуть лише зареєстровані користувачі.');},UndergroundMessageText:function(){return'Ми маємо вас попередити, що видалені коментарі можуть бути занадто експресивні, політично заангажовані, або взагалі не стосуватися теми. Переглядаючи їх, ви можете зіпсувати собі настрій. Ви впевнені, що воно вам потрібно?';},MessageHiderAuth:function($target){if(Template.IsMobile)Comments.MobileMessage($target,'<div>Переглядати видалені коментарі можуть лише зареєстровані користувачі.</div>'+Comments.MessageRegRow(),'after');else Comments.DesktopAuthMessage('Переглядати видалені коментарі можуть лише зареєстровані користувачі.');},MessageHider:function($target){var message_text=Comments.UndergroundMessageText();if(Template.IsMobile){Comments.MobileMessage($target,'<p>'+message_text+'</p><div style="margin: 0.5em;"><button style="padding: 0.33em 0.769em; font-size: 1em;">Показати коментарі</button></div>','after',function($message){$message.find('button').bind('click',function(){Comments.AcceptUnderground();var $message=$(this).parents('.message');var $hider=$message.parent().children('.comment-hider');$message.remove();$hider.find('a').trigger('click');});});}else{Dialog.Open({title:'Видалені коментарі',content:'<p style="margin: 10px";>'+message_text+'</p>',width:'360px',action:'',buttons:[{type:'button',value:'Я згоден',extend_class:'',fn:function(){Comments.AcceptUnderground();$target.find('a').trigger('click');$target.remove();Dialog.Close();}},{type:'button',value:'Краще не треба',extend_class:'',fn:Dialog.Close}]});}},MessageUndergroundAuth:function(){if(Template.IsMobile)Comments.MobileMessage(Comments.DOM.UndergroundTitle,'<div>Переглядати видалені коментарі можуть лише зареєстровані користувачі.</div>'+Comments.MessageRegRow(),'after');else Comments.DesktopAuthMessage('Переглядати видалені коментарі можуть лише зареєстровані користувачі.');},MessageUnderground:function(){var message_text=Comments.UndergroundMessageText();if(Template.IsMobile){Comments.MobileMessage(Comments.DOM.UndergroundTitle,'<p>'+message_text+'</p><div style="margin: 0.5em;"><button style="padding: 0.33em 0.769em; font-size: 1em;">Показати коментарі</button></div>','after',function($message){$message.find('button').bind('click',function(){Comments.AcceptUnderground();$(this).parents('.message').remove();Comments.OpenUnderground();});});}else{Dialog.Open({title:'Видалені коментарі',content:'<p style="margin: 10px";>'+message_text+'</p>',width:'360px',action:'',buttons:[{type:'button',value:'Я згоден',extend_class:'',fn:function(){Comments.AcceptUnderground();Comments.DOM.Underground.find('.message').remove();Dialog.Close();Comments.OpenUnderground();}},{type:'button',value:'Краще не треба',extend_class:'',fn:Dialog.Close}]});}},MessageSubmit:function($target,text){if(Template.IsMobile)Comments.MobileMessage($target,text,'append');else alert(text);},FacebookAuthComplete:function(){FacebookTools.AuthComplete(Comments.FacebookAuthSuccess,Comments.FacebookAuthError);},FacebookAuthSuccess:function(msg){$('#fb-comments-auth').html('<div class="message success">'+msg+'</div>');setTimeout(function(){location.reload()},1000);},FacebookAuthError:function(msg){$('#fb-comments-auth').html('<div class="message error">'+msg+'</div>');},Tools:{BR:function(text){text=escape(text);var re_nlchar;if(text.indexOf('%0D%0A')>-1){re_nlchar=/%0D%0A/g;}else if(text.indexOf('%0A')>-1){re_nlchar=/%0A/g;}else if(text.indexOf('%0D')>-1){re_nlchar=/%0D/g;}return unescape(text.replace(re_nlchar,'<br />'));},HTML_Links:function(text){var reLink=/https?:\/\/([a-zA-Z0-9.\/_#:?=&%;+!-]+)/g;var reDomain=/https?:\/\/([a-zA-Z0-9.-]+)/;var reValid=/^([a-z0-9-]+\.)+[a-z]{2,4}$/;var html=text.replace(reLink,function(link){if(reDomain.test(link)){var domain=RegExp.$1;if(reValid.test(domain))return'[&nbsp;<a href="'+link+'" style="text-decoration:none;" target="_blank">Лінк&nbsp;на&nbsp;'+domain+'</a>&nbsp;]';else return link;}else return link;});return html;},ToDate:function(value){var monthes=['січня','лютого','березня','квітня','травня','червня','липня','серпня','вересня','жовтня','листопада','грудня'];var today=new Date();var _day=0;var _month=0;var _year=0;var _hour=0;var _min=0;var reDate=/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})/;if(reDate.test(value)){_day=parseInt(RegExp.$3,10);_month=parseInt(RegExp.$2,10);_year=parseInt(RegExp.$1,10);_hour=parseInt(RegExp.$4,10);_min=parseInt(RegExp.$5,10);}else{var D=new Date();D.setTime(parseInt(value,10)*1000);_day=parseInt(D.getDate());_month=parseInt(D.getMonth())+1;_year=parseInt(D.getFullYear());_hour=parseInt(D.getHours());_min=parseInt(D.getMinutes());}var date='';if(today.getFullYear()==_year){if(today.getDate()==_day&&today.getMonth()==_month)date='Сьогодні,&nbsp;';else date=_day+'&nbsp;'+monthes[_month-1]+',&nbsp;';}else{date=_day+'.'+(_month<10?'0':'')+_month+'.'+_year+'&nbsp;,&nbsp;';}date+=_hour+':'+(_min<10?'0'+_min:_min);return date;},ToShortDate:function(value){var D_comment=new Date();var reDate=/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})/;if(reDate.test(value)){_day=parseInt(RegExp.$3,10);_month=parseInt(RegExp.$2,10);_year=parseInt(RegExp.$1,10);_hour=parseInt(RegExp.$4,10);_min=parseInt(RegExp.$5,10);D_comment=new Date(_year,_month-1,_day,_hour,_min,0);}else{D_comment.setTime(parseInt(value,10)*1000);}var ts_page=Comments.CurrentDate.valueOf()/1000;var ts_comment=D_comment.valueOf()/1000;var d=ts_page-ts_comment;if(d<60)return'Щойно';if(d<3600)return Math.floor(d/60)+'&nbsp;хв';if(d<86400)return Math.floor(d/3600)+'&nbsp;год';if(d<2592000)return Math.floor(d/86400)+'&nbsp;д.';if(d<31536000)return Math.floor(d/2592000)+'&nbsp;міс';return Math.floor(d/31536000)+'&nbsp;р';},NComments:function(n){var n_10=n%10;var n_100=n%100;var n_str='';if((n_10==0)||(n_10>=5&&n_10<=9)||(n_100>=11&&n_100<=14))n_str='коментарів';else if(n_10==1)n_str='коментар';else n_str='коментарі';return n+' '+n_str;}}};$(Comments.Init);var ContentTools={DOM:{},FontSize:100,Init:function(){ContentTools.DOM.ContentHeader=$('.content-header');ContentTools.DOM.DetailContent=ContentTools.DOM.ContentHeader.parents('.detail-content');ContentTools.DOM.Plus=ContentTools.DOM.ContentHeader.find('.icon-zoom-in');ContentTools.DOM.Minus=ContentTools.DOM.ContentHeader.find('.icon-zoom-out');ContentTools.CookieFontSize();ContentTools.DOM.Plus.add(ContentTools.DOM.Minus).bind('click',ContentTools.ChangeFontSize);ContentTools.InitPrintVersion();$('.content-telegram').css({'margin':'10px','text-align':'center'}).html('Підписуйтеся на <a href="https://t.me/poltava_to">канал «Полтавщини» у Telegram</a> та обговорюйте новини у <a href="https://t.me/poltava">чаті&nbsp;«Полтава»</a>');},CookieFontSize:function(){var font_size=parseInt($.cookie('font-size'));if(!isNaN(font_size))ContentTools.SetFontSize(font_size);},SetFontSize:function(font_size){var $content=ContentTools.DOM.DetailContent;font_size=parseInt(font_size,10);font_size=Math.min(140,Math.max(100,font_size));switch(font_size){case 120:$content.removeClass('font-size-140').addClass('font-size-120');break;case 140:$content.removeClass('font-size-120').addClass('font-size-140');break;default:$content.removeClass('font-size-120').removeClass('font-size-140');font_size=100;}if(ContentTools.FontSize!=font_size){ContentTools.FontSize=font_size;$.cookie('font-size',font_size,{expires:3,path:'/',domain:'poltava.to'});Template.OnResize();}},ChangeFontSize:function(){var $btn=$(this);var font_size=ContentTools.FontSize;if($btn.hasClass('icon-zoom-in'))font_size+=20;else font_size-=20;ContentTools.SetFontSize(font_size);},InitPrintVersion:function(){ContentTools.DOM.ContentHeader.find('.content-print').replaceWith('<a href="?print" rel="nofollow" class="display-table content-print">'+'<span class="display-row">'+'<span class="display-cell">Версія для друку</span>'+'<span class="display-cell">'+'<span class="icon icon-print"></span>'+'</span>'+'</span>'+'</a>');}};$(ContentTools.Init);var Orphus={DOM:{},MessageTimeout:0,Init:function(){if(!(/poltava\.to/.test(location.toString())))return;$(document).bind('keydown',function(e){if(e.ctrlKey&&e.keyCode==13){var text=Orphus.GetSelection();if(text!='')Orphus.OpenDialog(Orphus.ClearText(text));}});$('.content-orphus').text('Якщо ви помітили помилку, виділіть фрагмент тексту, що містить цю помилку та натисніть Ctrl+Enter.');},GetSelection:function(){if(window.getSelection){return window.getSelection();}else if(document.selection){return document.selection.createRange().text;}return'';},ClearText:function(text){return text.toString().substr(0,1000).replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');},Form:function(text){var html='<div style="padding: 10px 10px 5px 10px;">'+'<div class="dialog-orphus-message" style="padding: 5px; margin-bottom: 10px; display: none;"></div>'+'<textarea class="orphus-text make-focus" style="width: 100%; height: 160px; border: 0 none; background-color: #fafafa; padding: 0;">'+text+"\n---\n\r"+'</textarea>'+'</div>'+'<div style="padding: 0 10px 5px 10px; color: #999; font-size: 12px;">Опишіть помилку після скопійованого у форму тексту та натисніть кнопку «Повідомити редактору»</div>';return html;},OnReady:function(){Orphus.DOM.Textarea=Dialog.DOM.Holder.find('textarea.orphus-text');Orphus.DOM.Message=Dialog.DOM.Holder.find('div.dialog-orphus-message');Orphus.DOM.Textarea.each(function(){var $this=$(this);$this.focus();if(this.setSelectionRange){var len=$this.val().length*2;this.setSelectionRange(len,len);}else{$this.val($this.val());}});Orphus.DOM.SubmitButton=Dialog.DOM.Holder.find('input[type=submit]');},OpenDialog:function(text){Dialog.Open({title:'В тексті помилка!',content:Orphus.Form(text),width:'500px',action:'#',method:'post',extend_class:'',onready:Orphus.OnReady,onsubmit:Orphus.Send,buttons:[{type:'submit',value:'Повідомити редактору',fn:Orphus.Send},{type:'button',value:'Скасувати',fn:Dialog.Close}]});},Send:function(){var text=Orphus.DOM.Textarea.val();var url=location.toString();var author='';var $author=$('span.wym-author');if($author.length==1)author=$author.text();Orphus.ButtonStatus(false);$.ajax({url:'/ajax2/orphus.php',type:'post',dataType:'text',data:{text:text,url:url,author:author},success:Orphus.Complete,error:Orphus.Error});return false;},ButtonStatus:function(status){if(status==true)Orphus.DOM.SubmitButton.removeAttr('disabled').val('Повідомити редактору');else Orphus.DOM.SubmitButton.attr('disabled','disabled').val('Надсилається ...');},Complete:function(response){if(response=='OK'){Orphus.ShowMessage('Дякуємо за ваше повідомлення!',0,'success');setTimeout(Dialog.Close,2000);}else{Orphus.ShowMessage(response);Orphus.ButtonStatus(true);}},Error:function(){Orphus.ShowMessage('Відсутній зв’язок з сервером.<br />Перевірте підключення до інтернету.');Orphus.ButtonStatus(true);},ShowMessage:function(msg,time,msg_class){if(typeof(time)=='undefined')time=7000;if(Orphus.MessageTimeout>0)clearTimeout(Orphus.MessageTimeout);if(typeof(msg_class)=='undefined'||!(msg_class=='success'||msg_class=='error'))msg_class='error';Orphus.DOM.Message.removeClass('error').removeClass('success').addClass(msg_class).html(msg).fadeIn();if(typeof(time)!='undefined'&&time>0)setTimeout(Orphus.HideMessage,time);},HideMessage:function(){Orphus.DOM.Message.fadeOut();},};$(Orphus.Init);var Lenta={DOM:{},Init:function(){Lenta.DOM.TBlock=$('.lenta');if(Lenta.DOM.TBlock.length!=1)return;Lenta.DOM.Content=Lenta.DOM.TBlock.find('.lenta-content');if(Lenta.DOM.TBlock.attr('data-noindex')==1)Lenta.InitContent();Lenta.DOM.Stream=Lenta.DOM.TBlock.find('.lenta-stream');Lenta.DOM.Blocks=Lenta.DOM.Stream.find('.lenta-post');Lenta.DOM.Buttons=Lenta.DOM.TBlock.find('.lenta-buttons');Lenta.DOM.MoreButton=Lenta.DOM.Buttons.find('.more-button');Lenta.DOM.MoreButton.attr('data-active',Lenta.DOM.MoreButton.text());Lenta.DOM.MoreButton.bind('click',Lenta.LoadMore);Template.AddResize(Lenta.OnResize,10);Template.OnResize();},GetAfterBnr:function(){var $li=Lenta.DOM.Content.find('.bn:last').nextAll('ul').find('li.lenta-post');;return $li.length;},InitContent:function(){var b64=Lenta.DOM.Content.attr('data-stream');if(typeof(b64)!='undefined'){Lenta.DOM.Content.html($.base64.atob(b64,true));Lenta.DOM.Content.attr('data-stream','');}},LoadMore:function(){if(Lenta.DOM.MoreButton.hasClass('tbutton-disabled'))return false;Lenta.ButtonStatus('loading');$.ajax({url:'/ajax2/lenta.php',type:'post',dataType:'text',data:{type:Lenta.DOM.MoreButton.attr('data-type'),source:Lenta.DOM.MoreButton.attr('data-source'),dt:Lenta.DOM.MoreButton.attr('data-dt')},success:Lenta.LoadComplete,error:Lenta.LoadError});return false;},ButtonStatus:function(status){var $button=Lenta.DOM.MoreButton;switch(status){case'loading':var text=$button.attr('data-loading');$button.removeClass('tbutton-active').addClass('tbutton-disabled').text(text);break;case'active':var text=$button.attr('data-active');$button.removeClass('tbutton-disabled').addClass('tbutton-active').text(text);break;case'end':var text=$button.attr('data-end');$button.removeClass('tbutton-active').addClass('tbutton-disabled').text(text);break;}},LoadComplete:function(response){var after_bnr=Lenta.GetAfterBnr();var new_bnr_count=0;var $html=$('<div>'+response+'</div>');var n1=Lenta.DOM.Content.find('li').length;$html.find('ul').each(function(){var $ul=$(this);$ul.find('.lenta-post').addClass('mobile-only');var data_dt=$ul.attr('data-dt');var $exist_ul=Lenta.DOM.Content.find('ul[data-dt='+data_dt+']');if($exist_ul.length>0){var links=[];$exist_ul.find('a.link').each(function(){var $a=$(this);links.push($a.attr('href'));});$ul.find('li.lenta-post').each(function(){var $li=$(this);var url=$li.find('a.link').attr('href');if(links.indexOf(url)===-1){$exist_ul.append($li);after_bnr++;}});}else{if(after_bnr>=5){Lenta.DOM.Content.append('<div class="bn bn-lenta"></div>');after_bnr=0;new_bnr_count++;}Lenta.DOM.Content.append($ul);after_bnr+=$ul.find('li.lenta-post').length;}});var $li=Lenta.DOM.Content.find('li');var n2=$li.length;if(n2>n1){var last_dt=$li.last().attr('data-dt');Lenta.DOM.MoreButton.attr('data-dt',last_dt);Lenta.ButtonStatus('active');}else{Lenta.ButtonStatus('end');}Lenta.DOM.Blocks=Lenta.DOM.Stream.find('.lenta-post');if(new_bnr_count>0&&typeof(BC3)!='undefined')BC3.Update();Template.OnResize();},LoadError:function(){alert('Помилка при завантаженні стрічки');Lenta.ButtonStatus('active');},OnResize:function(){if(Template.IsMobile){}else{var optimal_height=Math.max(Template.ContentHeight,Template.MinHeight);var lenta_height=Lenta.DOM.TBlock.height();var n=Lenta.DOM.Blocks.length;if(lenta_height>optimal_height){for(var i=n-1;i>=0;i--){var $block=Lenta.DOM.Blocks.eq(i);if($block.hasClass('mobile-only'))continue;$block.addClass('mobile-only');lenta_height=Lenta.DOM.TBlock.height();if(lenta_height<=optimal_height){$block.removeClass('mobile-only');break;}}}else if(lenta_height<optimal_height){for(var i=0;i<n;i++){var $block=Lenta.DOM.Blocks.eq(i);if($block.hasClass('mobile-only')){$block.removeClass('mobile-only');lenta_height=Lenta.DOM.TBlock.height();if(lenta_height>=optimal_height)break;}}}}}};$(Lenta.Init);!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Slideout=t()}}(function(){var t,e,n;return function i(t,e,n){function o(r,a){if(!e[r]){if(!t[r]){var u=typeof require=="function"&&require;if(!a&&u)return u(r,!0);if(s)return s(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var f=e[r]={exports:{}};t[r][0].call(f.exports,function(e){var n=t[r][1][e];return o(n?n:e)},f,f.exports,i,t,e,n)}return e[r].exports}var s=typeof require=="function"&&require;for(var r=0;r<n.length;r++)o(n[r]);return o}({1:[function(t,e,n){"use strict";var i=t("decouple");var o=t("emitter");var s;var r=false;var a=window.document;var u=a.documentElement;var l=window.navigator.msPointerEnabled;var f={start:l?"MSPointerDown":"touchstart",move:l?"MSPointerMove":"touchmove",end:l?"MSPointerUp":"touchend"};var h=function v(){var t=/^(Webkit|Khtml|Moz|ms|O)(?=[A-Z])/;var e=a.getElementsByTagName("script")[0].style;for(var n in e){if(t.test(n)){return"-"+n.match(t)[0].toLowerCase()+"-"}}if("WebkitOpacity"in e){return"-webkit-"}if("KhtmlOpacity"in e){return"-khtml-"}return""}();function c(t,e){for(var n in e){if(e[n]){t[n]=e[n]}}return t}function p(t,e){t.prototype=c(t.prototype||{},e.prototype)}function d(t){while(t.parentNode){if(t.getAttribute("data-slideout-ignore")!==null){return t}t=t.parentNode}return null}function _(t){t=t||{};this._startOffsetX=0;this._currentOffsetX=0;this._opening=false;this._moved=false;this._opened=false;this._preventOpen=false;this._touch=t.touch===undefined?true:t.touch&&true;this._side=t.side||"left";this.panel=t.panel;this.menu=t.menu;if(!this.panel.classList.contains("slideout-panel")){this.panel.classList.add("slideout-panel")}if(!this.panel.classList.contains("slideout-panel-"+this._side)){this.panel.classList.add("slideout-panel-"+this._side)}if(!this.menu.classList.contains("slideout-menu")){this.menu.classList.add("slideout-menu")}if(!this.menu.classList.contains("slideout-menu-"+this._side)){this.menu.classList.add("slideout-menu-"+this._side)}this._fx=t.fx||"ease";this._duration=parseInt(t.duration,10)||300;this._tolerance=parseInt(t.tolerance,10)||70;this._padding=this._translateTo=parseInt(t.padding,10)||256;this._orientation=this._side==="right"?-1:1;this._translateTo*=this._orientation;if(this._touch){this._initTouchEvents()}}p(_,o);_.prototype.open=function(){var t=this;this.emit("beforeopen");if(!u.classList.contains("slideout-open")){u.classList.add("slideout-open")}this._setTransition();this._translateXTo(this._translateTo);this._opened=true;setTimeout(function(){t.panel.style.transition=t.panel.style["-webkit-transition"]="";t.emit("open")},this._duration+50);return this};_.prototype.close=function(){var t=this;if(!this.isOpen()&&!this._opening){return this}this.emit("beforeclose");this._setTransition();this._translateXTo(0);this._opened=false;setTimeout(function(){u.classList.remove("slideout-open");t.panel.style.transition=t.panel.style["-webkit-transition"]=t.panel.style[h+"transform"]=t.panel.style.transform="";t.emit("close")},this._duration+50);return this};_.prototype.toggle=function(){return this.isOpen()?this.close():this.open()};_.prototype.isOpen=function(){return this._opened};_.prototype._translateXTo=function(t){this._currentOffsetX=t;this.panel.style[h+"transform"]=this.panel.style.transform="translateX("+t+"px)";return this};_.prototype._setTransition=function(){this.panel.style[h+"transition"]=this.panel.style.transition=h+"transform "+this._duration+"ms "+this._fx;return this};_.prototype._initTouchEvents=function(){var t=this;this._onScrollFn=i(a,"scroll",function(){if(!t._moved){clearTimeout(s);r=true;s=setTimeout(function(){r=false},250)}});this._preventMove=function(e){if(t._moved){e.preventDefault()}};a.addEventListener(f.move,this._preventMove);this._resetTouchFn=function(e){if(typeof e.touches==="undefined"){return}t._moved=false;t._opening=false;t._startOffsetX=e.touches[0].pageX;t._preventOpen=!t._touch||!t.isOpen()&&t.menu.clientWidth!==0};this.panel.addEventListener(f.start,this._resetTouchFn);this._onTouchCancelFn=function(){t._moved=false;t._opening=false};this.panel.addEventListener("touchcancel",this._onTouchCancelFn);this._onTouchEndFn=function(){if(t._moved){t.emit("translateend");t._opening&&Math.abs(t._currentOffsetX)>t._tolerance?t.open():t.close()}t._moved=false};this.panel.addEventListener(f.end,this._onTouchEndFn);this._onTouchMoveFn=function(e){if(r||t._preventOpen||typeof e.touches==="undefined"||d(e.target)){return}var n=e.touches[0].clientX-t._startOffsetX;var i=t._currentOffsetX=n;if(Math.abs(i)>t._padding){return}if(Math.abs(n)>20){t._opening=true;var o=n*t._orientation;if(t._opened&&o>0||!t._opened&&o<0){return}if(!t._moved){t.emit("translatestart")}if(o<=0){i=n+t._padding*t._orientation;t._opening=false}if(!(t._moved&&u.classList.contains("slideout-open"))){u.classList.add("slideout-open")}t.panel.style[h+"transform"]=t.panel.style.transform="translateX("+i+"px)";t.emit("translate",i);t._moved=true}};this.panel.addEventListener(f.move,this._onTouchMoveFn);return this};_.prototype.enableTouch=function(){this._touch=true;return this};_.prototype.disableTouch=function(){this._touch=false;return this};_.prototype.destroy=function(){this.close();a.removeEventListener(f.move,this._preventMove);this.panel.removeEventListener(f.start,this._resetTouchFn);this.panel.removeEventListener("touchcancel",this._onTouchCancelFn);this.panel.removeEventListener(f.end,this._onTouchEndFn);this.panel.removeEventListener(f.move,this._onTouchMoveFn);a.removeEventListener("scroll",this._onScrollFn);this.open=this.close=function(){};return this};e.exports=_},{decouple:2,emitter:3}],2:[function(t,e,n){"use strict";var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function o(t,e,n){var o,s=false;function r(t){o=t;a()}function a(){if(!s){i(u);s=true}}function u(){n.call(t,o);s=false}t.addEventListener(e,r,false);return r}e.exports=o},{}],3:[function(t,e,n){"use strict";var i=function(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}};n.__esModule=true;var o=function(){function t(){i(this,t)}t.prototype.on=function e(t,n){this._eventCollection=this._eventCollection||{};this._eventCollection[t]=this._eventCollection[t]||[];this._eventCollection[t].push(n);return this};t.prototype.once=function n(t,e){var n=this;function i(){n.off(t,i);e.apply(this,arguments)}i.listener=e;this.on(t,i);return this};t.prototype.off=function o(t,e){var n=undefined;if(!this._eventCollection||!(n=this._eventCollection[t])){return this}n.forEach(function(t,i){if(t===e||t.listener===e){n.splice(i,1)}});if(n.length===0){delete this._eventCollection[t]}return this};t.prototype.emit=function s(t){var e=this;for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++){i[o-1]=arguments[o]}var s=undefined;if(!this._eventCollection||!(s=this._eventCollection[t])){return this}s=s.slice(0);s.forEach(function(t){return t.apply(e,i)});return this};return t}();n["default"]=o;e.exports=n["default"]},{}]},{},[1])(1)});var SlideoutMenu={DOM:{},Instance:null,Init:function(){SlideoutMenu.DOM.Button=$('#slideout-button');SlideoutMenu.Instance=new Slideout({'panel':document.getElementById('slideout-panel'),'menu':document.getElementById('slideout-menu'),'touch':false});$('#slideout-menu').removeClass('slideout-menu-hidden');SlideoutMenu.DOM.Button.on('click',SlideoutMenu.Toggle);},Toggle:function(){SlideoutMenu.Instance.toggle();return false;}};$(SlideoutMenu.Init);